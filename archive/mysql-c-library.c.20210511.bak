//  Author -- Geoffrey Jarman
//  Started -- 12-Apr-2020
//  References:
//      https://qnaplus.com/how-to-access-mysql-database-from-c-program/
//  Compliation:
//      gcc -g -o mysql-c-library $(mysql_config --cflags) mysql-c-library.c $(mysql_config --libs) cs50.c
//  Log: 
//      12-Apr-2021 started
//      12-Apr-2021 reviewed all
//      12-Apr-2021 consolecode
//      12-Apr-2021 function to print titles and authors
//      13-Apr-2021 function to add attribute - shell outline
//      14-Apr-2021 functions to add new attributes
//      15-Apr-2021 function to title with unassigned attribute for foreign keys
//      15-Apr-2021 title and attribute maintenance start
//      16-Apr-2021 attribute descriptions
//      17-Apr-2021 restriction on valid title ID range to enter to lookup a title
//      18-Apr-2021 function fUpdateTitleAndAttributes() to change attributes
//      18-Apr-2021 function to show numbered attributes
//      19-Apr-2021 function to show numbered characters on the console
//      19-Apr-2021 function to add characters
//      20-Apr-2021 function to search title names
//      20-Apr-2021 function to clear the screen
//      21-Apr-2021 make X a universal exit key
//      22-Apr-2021 x exit shortcut for options after 'maintain attributes' on the main menu
//      22-Apr-2021 standard menus with character shortcuts
//      23-Apr-2021 fShow functions on Attribute updates for classification and rating
//      25-Apr-2021 narrow list layout for titles
//      25-Apr-2021 start of character maintenance and debugging
//      25-Apr-2021 update and delete characters
//      25-Apr-2021 option to list titles descending
//      25-Apr-2021 character count on lists
//      25-Apr-2021 title name on attribute update page
//      26-Apr-2021 title name on character update page
//      26-Apr-2021 escape the ' character in strings
//      26-Apr-2021 check a title exists in title ID queries
//      27-Apr-2021 paginate long list: authors and series
//      27-Apr-2021 explicit returns on all functions
//      27-Apr-2021 show attribute value choices when updating attributes
//      27-Apr-2021 escape option from adding attributes
//      28-Apr-2021 fix bug entering a bad date on attribute maintenance
//      28-Apr-2021 show all attributes and characters for in a single title
//      28-Apr-2021 allow nulling out the dates on a title in Attribute Updates
//      28-Apr-2021 remove unused option choices
//      28-Apr-2021 list authors and title counts
//      28-Apr-2021 format SQl in sprintf statements
//      03-May-2021 remove double 'Press enter to continue" messages when print block ends
//      03-May-2021 remove double prompt for Title search adding characters
//      03-May-2021 remove double prompt for Title search updating attributes
//      03-May-2021 modify getchar() to clear the buffer
//      03-May-2021 search or list authors adding attributes
//      04-May-2021 delete for attribute maintenance on authors
//      04-May-2021 change add to maintain attributes
//      04-May-2021 search or list Series adding attributes
//      04-May-2021 add a title count to author listings
//      04-May-2021 add a title count to series listings
//      05-May-2021 search, delete functions to attribute maintenance for Genres
//      05-May-2021 search, delete functions to attribute maintenance for Sources
//      05-May-2021 search, delete functions to attribute maintenance for Ratings
//      05-May-2021 search, delete functions to attribute maintenance for Statuses
//      06-may-2021 search, delete functions to attribute maintenance for Classifications
//      06-May-2021 troubleshoot connection statements in functions
//      07-May-2021 fEscapeSingleQuotes on adding comments
//      07-May-2021 error trap for mysql_query() errors
//      08-May-2021 finish adding a change option to attribute maintenance
//      09-May-2021 allow nulls start date on new title
//      09-May-2021 add status filters to title listing
//      09-May-2021 escape changing an author name with an embedded '
//      09-May-2021 dynamically size names in listings
//      09-May-2021 left-justify number columns in listings past Author listing
//      10-May-2021 streamline error printing with __func__
//      10-May-2021 streamline error detection blocks
//      11-May-2021 block adding empty attributes by hitting enter without text
//  Enhancements:
//      Check field lengths on additions and changes using SELECT column_name, character_maximum_length FROM INFORMATION_SCHEMA.COLUMNS where table_name = 'Book Titles' and column_name = 'Title Name'; 

// includes and defines

#include <mysql.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "cs50.h"
#include <ctype.h>
#include <stdbool.h>

#define SQL_LEN 5000

void fListTitles(char *, int *, char *, char *);       //show all titles and authors on the console
void fListAuthors(char *, int *, char *, char *);//show all authors and title counts on the console
void fMaintainAttributes(char *, int *);
void fSetOptions(char *, int *, char *, char *);
int  fAddSeries(char *);                      // add a series, return 0 if not added and 1 if added
int  fAddAuthor(char *);                     // add an author, return 0 if not added and 1 if added
int  fAddClassification(char *);       // add a classificatin, return 0 if not added and 1 if added
int  fAddRating(char *);                      // add a rating, return 0 if not added and 1 if added
int  fAddSource(char *);                      // add a source, return 0 if not added and 1 if added
int  fAddStatus(char *);                      // add a status, return 0 if not added and 1 if added
int  fAddGenre(char *);                        // add a genre, return 0 if not added and 1 if added
void fAddTitle(char *);                                      // add a title with default attributes
void fCharacters(char *);                         // view, add, change delete characters on a title
void fUpdateTitleAndAttributes(char *, int *);   // update attributes of a Title but not characters
int  fGetMaxTitleID(void);                                       // get the max value of Title ID's
int  fGetMinTitleID(void);                                       // get the min value of Title ID's
void fShowAttributes(int);                                  // show title attributes on the console
void fShowCharacters(int, char *);                                // show characters on the console
void fSearchTitles(char *);                                    // search titles and show a title ID
void fRetitleConsole(char *);                                      // clear and retitle the console
void fShowAllAuthors(int *);                                     // show all authors on the console
void fShowAllSeries(int *);                                       // show all series on the console
void fShowAllSources(int *);                                     // show all sources on the console
void fShowAllGenres(int *);                                       // show all genres on the console
void fShowAllStatuses(int *);                                   // show all statuses on the console
void fShowAllClassifications(int *);                     // show all classifications on the console
void fShowAllRatings(int *);                                     // show all ratings on the console
void fShowTitle(int, char *);                                   // show a title name on the console
char *fEscapeSingleQuote(char *);                    // escape ' as '' for mysql in string literals
bool fCheckTitleIDExists(int);                        // check a Title ID and return True if exists
void fSearchAuthors(char *);                                // search authors and show an author id
void fDeleteAuthor(char *);                                      // delete an author with no titles
void fSearchSeries(char *);                                   // search series and show a series ID
void fDeleteSeries(char *);                                       // delete a series with no titles
void fDeleteGenre(char *);                                         // delete a genre with no titles
void fSearchGenres(char *);                                    // search genres and show a genre ID
void fDeleteSource(char *);                                       // delete a source with no titles
void fSearchSources(char *);                                 // search sources and show a source ID
void fDeleteRating(char *);                                       // delete a rating with no titles
void fSearchRatings(char *);                                 // search ratings and show a rating ID
void fDeleteStatus(char *);                                       // delete a status with no titles
void fSearchStatuses(char *);                               // search statuses and show a status ID
void fDeleteClassification(char *);                       // delete a classification with no titles
void fSearchClassifications(char *);         // search classifications and show a classification ID
void fUpdateAuthor(char *);                                                     // update an author
void fUpdateClassification(char *);                                      // update a classification
void fUpdateRating(char *);                                                      // update a rating
void fUpdateSeries(char *);                                                      // update a series
void fUpdateSource(char *);                                                      // update a source
void fUpdateStatus(char *);                                                      // update a status
void fUpdateGenre(char *);                                                       // update an genre

int main(int argc, char** argv)
{
// declarations

    char *strPrgNme = argv[0] + 2;                                                  // program name
    bool bHelp = false;                                              // help flag to show help text
    bool bExitMain = false;                                             // flag to exit the program
    char charMainChoice = '0';                                                  // main menu choice
    int  intDisplayPageLength = 83;                                // display page lines for paging
    char charDisplayPageWidth = 'N';                           // display page width wide or narrow
    char charDisplayOrder = 'A';                           // display order asc or desc on Title ID

// Search for input parameters

    for(int i = 1; i < argc; i++)
    {
        if(strcmp("--help", argv[i]) == 0 || strcmp("--h", argv[i]) == 0)
        {
            bHelp = true;
        }
    }

    if(bHelp == true)
    {
        printf("\n");
        printf("Command line switch --h or --help not specified so help suppressed");
        printf("\n");
    }

// print the main menu

    while(bExitMain == false)
    {
        while(charMainChoice == '0')
        {
            fRetitleConsole(strPrgNme);
            printf("\n");
            printf("Main Menu");
            printf("\n\n");
            printf("1. (L)ist Titles");
            printf("\n");
            printf("2. List Autho(r)s");
            printf("\n");
            printf("3. Add a (T)itle");
            printf("\n");
            printf("4. Maintain (A)ttributes");
            printf("\n");
            printf("5. (U)pdate a Title and Attributes");
            printf("\n");
            printf("6. (C)haracters");
            printf("\n");
            printf("7. O(p)tions");
            printf("\n");
            printf("8. E(x)it");
            printf("\n\n");
            printf("Choice: ");
            charMainChoice = GetChar();
            if(strchr("12345678xXcCpPuUaAlLtTrR", charMainChoice) == NULL)
            {
                charMainChoice = '0';
                fRetitleConsole(strPrgNme);
                printf("\n");
            }
        }
        
        if(strchr("1lL", charMainChoice) != NULL)
        {
            printf("\n");
            fListTitles(strPrgNme, &intDisplayPageLength, &charDisplayPageWidth, &charDisplayOrder);
            printf("\n");
            charMainChoice = '0';
            bExitMain = false;
        }
        else if(strchr("2rR", charMainChoice) != NULL)
        {
            printf("\n");
            fListAuthors(strPrgNme, &intDisplayPageLength, &charDisplayPageWidth, &charDisplayOrder);
            printf("\n");
            charMainChoice = '0';
            bExitMain = false;
        }
        else if(strchr("3tT", charMainChoice) != NULL)
        {
            printf("\n");
            fAddTitle(strPrgNme);
            printf("\n");
            charMainChoice = '0';
            bExitMain = false;
        }
        else if(strchr("aA4", charMainChoice) != NULL)
        {
            printf("\n");
            fMaintainAttributes(strPrgNme, &intDisplayPageLength);
            printf("\n");
            charMainChoice = '0';
            bExitMain = false;
        }
        else if(strchr("uU5", charMainChoice) != NULL)
        {
            printf("\n");
            fUpdateTitleAndAttributes(strPrgNme, &intDisplayPageLength);
            printf("\n");
            charMainChoice = '0';
            bExitMain = false;
        }
        else if(strchr("cC6", charMainChoice) != NULL)
        {
            printf("\n");
            fCharacters(strPrgNme);
            printf("\n");
            charMainChoice = '0';
            bExitMain = false;
        }
        else if(strchr("pP7", charMainChoice) != NULL)
        {
            printf("\n");
            fSetOptions(strPrgNme, &intDisplayPageLength, &charDisplayPageWidth, &charDisplayOrder);
            printf("\n");
            charMainChoice = '0';
            bExitMain = false;
        }
        else if(strchr("xX8", charMainChoice) != NULL)
        {
            bExitMain = true;
        }
    }

    (void) system("clear");

    return 0;
}

void fListTitles(char *strPrgNme, int *pintDisplayPageLength, char *pcharDisplayPageWidth, char *pCharDisplayOrder)
{
    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    int intColCount = 0;
    int *intLengths = NULL;
    int intRowCount = 0;
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    int  intStatusFilter = 0;
    char charStatusFilterChoice = '0';
    char strOrder[6] = {'D', 'E', 'S', 'C', '\0'};
    char strSQL[SQL_LEN] = {'\0'};
    bool bEndOfPrintBlock = false;

    if(*pCharDisplayOrder == 'A')
    {
        strcpy(strOrder, "ASC");
    }
    else if(*pCharDisplayOrder == 'D')
    {
        strcpy(strOrder, "DESC");
    }
    
    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > List Titles > Titles and Authors and Character Counts");
    printf("\n\n");
    printf("(A)ll, (U)nassigned, (N)ot Started, (S)tarted, (P)aused, (F)inished");
    printf("\n\n");
    while(strchr("aAuUnNsSfFpPxX", charStatusFilterChoice) == NULL)
    {
        printf("Choice: ");
        charStatusFilterChoice = toupper(GetChar());
    }
    if(charStatusFilterChoice == 'X')
    {
        return;
    }
    else if(charStatusFilterChoice == 'A')
    {
        intStatusFilter = 0;
    }
    else if(charStatusFilterChoice == 'U')
    {
        intStatusFilter = 6;
    }
    else if(charStatusFilterChoice == 'N')
    {
        intStatusFilter = 1;
    }
    else if(charStatusFilterChoice == 'S')
    {
        intStatusFilter = 2;
    }
    else if(charStatusFilterChoice == 'P')
    {
        intStatusFilter = 5;
    }
    else if(charStatusFilterChoice == 'F')
    {
        intStatusFilter = 4;
    }

    if(intStatusFilter == 0)
    {
        sprintf(strSQL, "SELECT T.`Title ID` , T.`Title Name` 'Title' , A.`Author Name` 'Author', "
                        "COUNT(C.`Character Name`) 'Chars', T.`Start`, T.`Finish`,"
                        "T.`Comments` FROM risingfast.`Book Titles` T "
                        "LEFT JOIN risingfast.`Book Authors` A ON T.`Author ID` = A.`Author ID`"
                        "LEFT JOIN risingfast.`Book Characters` C on T.`Title ID` = C.`Title ID`"
                        "GROUP BY T.`Title ID`"
                        "ORDER BY T.`Title ID` %s", strOrder);
    }
    else
    {
        sprintf(strSQL, "SELECT T.`Title ID` , T.`Title Name` 'Title' , A.`Author Name` 'Author', "
                        "COUNT(C.`Character Name`) 'Chars', T.`Start`, T.`Finish`,"
                        "T.`Comments` FROM risingfast.`Book Titles` T "
                        "LEFT JOIN risingfast.`Book Authors` A ON T.`Author ID` = A.`Author ID`"
                        "LEFT JOIN risingfast.`Book Characters` C on T.`Title ID` = C.`Title ID`"
                        "WHERE T.`Status ID` = %d "
                        "GROUP BY T.`Title ID`"
                        "ORDER BY T.`Title ID` %s", intStatusFilter, strOrder);
    }
// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("\n");
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// store the result of the query

    res = mysql_store_result(conn);
    if(res == NULL)
    {
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// fetch the number of fields in the result

    if(*pcharDisplayPageWidth == 'W')
    {
        intColCount = mysql_num_fields(res);
    }
    else if(*pcharDisplayPageWidth == 'N')
    {
        intColCount = mysql_num_fields(res) - 3;
    }

// fetch the max width of each column

    intLengths = (int *)calloc(intColCount, sizeof(int));

    while(row = mysql_fetch_row(res))
    {
        for (int k = 0; k < intColCount; k++)
        {
            if(row[k] != NULL)
            {
                if(strlen(row[k]) > intLengths[k])
                {
                     intLengths[k] = strlen(row[k]);
                }
            }
        }
    }

    mysql_data_seek(res, 0);

// print each row of results

    printf("\n");
    printf("Title, Author, Character Count");
    printf("\n\n");
    while(row = mysql_fetch_row(res))
    {
        bEndOfPrintBlock = false;
        intRowCount++;
        for(int i = 0; i < intColCount; i++)
        {
            if((i==3) || (i==0))
            {
                printf("%*s", intLengths[i] + 1, row[i] ? row[i] : "");
            }
            else
            {
                printf("  %-*s", intLengths[i] + 1, row[i] ? row[i] : "");
            }
        }
        printf("\n");
        if(intRowCount >= *pintDisplayPageLength)
        {
            printf("\n");
            printf("Press enter to continue ");
            bEndOfPrintBlock = true;
            while(getchar() != '\n')
            {
                continue;
            }
            printf("\n");
            intRowCount = 0;
        }
    }
    
    printf("\n");
    if(bEndOfPrintBlock == false)
    {
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
    }

    fRetitleConsole(strPrgNme);
    free(intLengths);
    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fMaintainAttributes(char *strPrgNme, int *pintDisplayPageLength)
{

    char charAttributeChoice = '0';
    char charAddChangeDeleteListSearchExitChoice = '0';
    char *strAuthorSearch = NULL;
    char *strSeriesSearch = NULL;
    char *strGenreSearch = NULL;
    char *strSourceSearch = NULL;
    char *strRatingSearch = NULL;
    char *strStatusSearch = NULL;
    char *strClassificationSearch = NULL;
    bool bExitAttributes = false;
    bool bAttributeAdded = false;

    fRetitleConsole(strPrgNme);

    while(bExitAttributes == false)
    {
        while(charAttributeChoice == '0')
        {
            bAttributeAdded = false;
            printf("\n");
            printf("Main Menu > Maintain Attributes");
            printf("\n\n");
            printf("1. (A)uthor");
            printf("\n");
            printf("2. (C)lassification");
            printf("\n");
            printf("3. (R)ating");
            printf("\n");
            printf("4. S(e)ries");
            printf("\n");
            printf("5. S(o)urces");
            printf("\n");
            printf("6. (S)tatuses");
            printf("\n");
            printf("7. (G)enres");
            printf("\n");
            printf("8. E(x)it");
            printf("\n\n");
            printf("Choice: ");
            charAttributeChoice = GetChar();
            if(strchr("12345678AaCcRrEeOoSsGgXx", charAttributeChoice) == NULL)
            {
                charAttributeChoice = 0;
            }
            printf("\n");
        }
        if(strchr("1Aa", charAttributeChoice) != NULL)
        {
            while(bAttributeAdded == false)
            {
                fRetitleConsole(strPrgNme);
                printf("\n");
                printf("Main Menu > Maintain Attributes > Authors");
                printf("\n\n");
                printf("(A)dd, (C)hange, (D)elete, (L)ist, (S)earch or E(x)it: ");
                charAddChangeDeleteListSearchExitChoice = toupper(GetChar());
                if(charAddChangeDeleteListSearchExitChoice == 'A')
                {
                    printf("\n");
                    if(fAddAuthor(strPrgNme) == 0)
                    {
                        bAttributeAdded = false;
                    }
                    else
                    {
                        bAttributeAdded = true;
                    }
                    charAttributeChoice = '0';
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'C')
                {
                    printf("\n");
                    fUpdateAuthor(strPrgNme);
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'D')
                {
                    printf("\n");
                    fDeleteAuthor(strPrgNme);
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'L')
                {
                    printf("\n");
                    fRetitleConsole(strPrgNme);
                    printf("\n");
                    printf("Main Menu > Maintain Attributes > Authors > List");
                    printf("\n\n");
                    fShowAllAuthors(pintDisplayPageLength);
                    printf("Press enter to continue ");
                    while(getchar() != '\n')
                    {
                        continue;
                    }
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'S')
                {
                    printf("\n");
                    fRetitleConsole(strPrgNme);
                    printf("\n");
                    printf("Main Menu > Maintain Attributes > Authors > Search");
                    printf("\n\n");
                    printf("Search String or E(x)it: ");
                    strAuthorSearch = GetString();
                    if(strstr("xX", strAuthorSearch) != NULL)
                    {
                        continue;
                    }
                    fSearchAuthors(strAuthorSearch);
                    printf("\n");
                    printf("Press enter to continue ");
                    while(getchar() != '\n')
                    {
                        continue;
                    }
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'X')
                {
                    bAttributeAdded = true;
                    charAttributeChoice = '0';
                }
            }
        }
        else if(strchr("2Cc", charAttributeChoice) != NULL)
        {
            while(bAttributeAdded == false)
            {
                fRetitleConsole(strPrgNme);
                printf("\n");
                printf("Main Menu > Maintain Attributes > Classifications");
                printf("\n\n");
                printf("(A)dd, (C)hange, (D)elete, (L)ist, (S)earch or E(x)it: ");
                charAddChangeDeleteListSearchExitChoice = toupper(GetChar());
                if(charAddChangeDeleteListSearchExitChoice == 'A')
                {
                    printf("\n");
                    if(fAddClassification(strPrgNme) == 0)
                    {
                        bAttributeAdded = false;
                    }
                    else
                    {
                        bAttributeAdded = true;
                    }
                    charAttributeChoice = '0';
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'C')
                {
                    printf("\n");
                    fUpdateClassification(strPrgNme);
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'D')
                {
                    printf("\n");
                    fDeleteClassification(strPrgNme);
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'L')
                {
                    printf("\n");
                    fRetitleConsole(strPrgNme);
                    printf("\n");
                    printf("Main Menu > Maintain Attributes > Classifications > List");
                    printf("\n\n");
                    fShowAllClassifications(pintDisplayPageLength);
                    printf("Press enter to continue ");
                    while(getchar() != '\n')
                    {
                        continue;
                    }
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'S')
                {
                    printf("\n");
                    fRetitleConsole(strPrgNme);
                    printf("\n");
                    printf("Main Menu > Maintain Attributes > Classifications > Search");
                    printf("\n\n");
                    printf("Search String or E(x)it: ");
                    strClassificationSearch = GetString();
                    if(strstr("xX", strClassificationSearch) != NULL)
                    {
                        continue;
                    }
                    fSearchClassifications(strClassificationSearch);
                    printf("\n");
                    printf("Press enter to continue ");
                    while(getchar() != '\n')
                    {
                        continue;
                    }
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'X')
                {
                    bAttributeAdded = true;
                    charAttributeChoice = '0';
                }
            }
        }
        else if(strchr("3Rr", charAttributeChoice) != NULL)
        {
            while(bAttributeAdded == false)
            {
                fRetitleConsole(strPrgNme);
                printf("\n");
                printf("Main Menu > Maintain Attributes > Ratings");
                printf("\n\n");
                printf("(A)dd, (C)hange, (D)elete, (L)ist, (S)earch or E(x)it: ");
                charAddChangeDeleteListSearchExitChoice = toupper(GetChar());
                if(charAddChangeDeleteListSearchExitChoice == 'A')
                {
                    printf("\n");
                    if(fAddRating(strPrgNme) == 0)
                    {
                        bAttributeAdded = false;
                    }
                    else
                    {
                        bAttributeAdded = true;
                    }
                    charAttributeChoice = '0';
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'C')
                {
                    printf("\n");
                    fUpdateRating(strPrgNme);
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'D')
                {
                    printf("\n");
                    fDeleteRating(strPrgNme);
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'L')
                {
                    printf("\n");
                    fRetitleConsole(strPrgNme);
                    printf("\n");
                    printf("Main Menu > Maintain Attributes > Ratings > List");
                    printf("\n\n");
                    fShowAllRatings(pintDisplayPageLength);
                    printf("Press enter to continue ");
                    while(getchar() != '\n')
                    {
                        continue;
                    }
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'S')
                {
                    printf("\n");
                    fRetitleConsole(strPrgNme);
                    printf("\n");
                    printf("Main Menu > Maintain Attributes > Ratings > Search");
                    printf("\n\n");
                    printf("Search String or E(x)it: ");
                    strRatingSearch = GetString();
                    if(strstr("xX", strRatingSearch) != NULL);
                    {
                        continue;
                    }
                    fSearchRatings(strRatingSearch);
                    printf("\n");
                    printf("Press enter to continue ");
                    while(getchar() != '\n')
                    {
                        continue;
                    }
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'X')
                {
                    bAttributeAdded = true;
                    charAttributeChoice = '0';
                }
            }
        }
        else if(strchr("4Ee", charAttributeChoice) != NULL)
        {
            while(bAttributeAdded == false)
            {
                fRetitleConsole(strPrgNme);
                printf("\n");
                printf("Main Menu > Maintain Attributes > Series");
                printf("\n\n");
                printf("(A)dd, (C)hange, (D)elete, (L)ist, (S)earch or E(x)it: ");
                charAddChangeDeleteListSearchExitChoice = toupper(GetChar());
                if(charAddChangeDeleteListSearchExitChoice == 'A')
                {
                    printf("\n");
                    if(fAddSeries(strPrgNme) == 0)
                    {
                        bAttributeAdded = false;
                    }
                    else
                    {
                        bAttributeAdded = true;
                    }
                    charAttributeChoice = '0';
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'C')
                {
                    printf("\n");
                    fUpdateSeries(strPrgNme);
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'D')
                {
                    printf("\n");
                    fDeleteSeries(strPrgNme);
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'L')
                {
                    printf("\n");
                    fRetitleConsole(strPrgNme);
                    printf("\n");
                    printf("Main Menu > Maintain Attributes > Series > List");
                    printf("\n\n");
                    fShowAllSeries(pintDisplayPageLength);
                    printf("Press enter to continue ");
                    while(getchar() != '\n')
                    {
                        continue;
                    }
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'S')
                {
                    printf("\n");
                    fRetitleConsole(strPrgNme);
                    printf("\n");
                    printf("Main Menu > Maintain Attributes > Series > Search");
                    printf("\n\n");
                    printf("Search String or E(x)it: ");
                    strSeriesSearch = GetString();
                    if(strstr("xX", strSeriesSearch) != NULL)
                    {
                        continue;
                    }
                    fSearchSeries(strSeriesSearch);
                    printf("\n");
                    printf("Press enter to continue ");
                    while(getchar() != '\n')
                    {
                        continue;
                    }
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'X')
                {
                    bAttributeAdded = true;
                    charAttributeChoice = '0';
                }
            }
        }
        else if(strchr("5Oo", charAttributeChoice) != NULL)
        {
            while(bAttributeAdded == false)
            {
                fRetitleConsole(strPrgNme);
                printf("\n");
                printf("Main Menu > Maintain Attribues > Sources");
                printf("\n\n");
                printf("(A)dd, (C)hange, (D)elete, (L)ist, (S)earch or E(x)it: ");
                charAddChangeDeleteListSearchExitChoice = toupper(GetChar());
                if(charAddChangeDeleteListSearchExitChoice == 'A')
                {
                    printf("\n");
                    if(fAddSource(strPrgNme) == 0)
                    {
                        bAttributeAdded = false;
                    }
                    else
                    {
                        bAttributeAdded = true;
                    }
                    charAttributeChoice = '0';
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'C')
                {
                    printf("\n");
                    fUpdateSource(strPrgNme);
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'D')
                {
                    printf("\n");
                    fDeleteSource(strPrgNme);
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'L')
                {
                    printf("\n");
                    fRetitleConsole(strPrgNme);
                    printf("\n");
                    printf("Main Menu > Maintain Attributes > Sources > List");
                    printf("\n\n");
                    fShowAllSources(pintDisplayPageLength);
                    printf("Press enter to continue ");
                    while(getchar() != '\n')
                    {
                        continue;
                    }
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'S')
                {
                    printf("\n");
                    fRetitleConsole(strPrgNme);
                    printf("\n");
                    printf("Main Menu > Maintain Attributes > Sources > Search");
                    printf("\n\n");
                    printf("Search String or E(x)it: ");
                    strSourceSearch = GetString();
                    if(strstr("xX", strSourceSearch) != NULL)
                    {
                        continue;
                    }
                    fSearchSources(strSourceSearch);
                    printf("\n");
                    printf("Press enter to continue ");
                    while(getchar() != '\n')
                    {
                        continue;
                    }
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'X')
                {
                     bAttributeAdded = true;
                     charAttributeChoice = '0';
                }
            }
        }
        else if(strchr("6Ss", charAttributeChoice) != NULL)
        {
            while(bAttributeAdded == false)
            {
                fRetitleConsole(strPrgNme);
                printf("\n");
                printf("Main Menu > Maintain Attributes > Statuses");
                printf("\n\n");
                printf("(A)dd, (C)hange, (D)elete, (L)ist, (S)earch or E(x)it: ");
                charAddChangeDeleteListSearchExitChoice = toupper(GetChar());
                if(charAddChangeDeleteListSearchExitChoice == 'A')
                {
                    printf("\n");
                    if(fAddStatus(strPrgNme) == 0)
                    {
                        bAttributeAdded = false;
                    }
                    else
                    {
                        bAttributeAdded = true;
                    }
                    charAttributeChoice = '0';
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'C')
                {
                    printf("\n");
                    fUpdateStatus(strPrgNme);
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'D')
                {
                     printf("\n");
                     fDeleteStatus(strPrgNme);
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'L')
                {
                    printf("\n");
                    fRetitleConsole(strPrgNme);
                    printf("\n");
                    printf("Main Menu > Maintain Attributes > Statuses > List");
                    printf("\n\n");
                    fShowAllStatuses(pintDisplayPageLength);
                    printf("Press enter to continue ");
                    while(getchar() != '\n')
                    {
                        continue;
                    }
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'S')
                {
                    printf("\n");
                    fRetitleConsole(strPrgNme);
                    printf("\n");
                    printf("Main Menu > Maintain Attributes > Statuses > Search");
                    printf("\n\n");
                    printf("Search String or E(x)it: ");
                    strStatusSearch = GetString();
                    if(strstr("xX", strStatusSearch) != NULL)
                    {
                        continue;
                    }
                    fSearchStatuses(strStatusSearch);
                    printf("\n");
                    printf("Press enter to continue ");
                    while(getchar() != '\n')
                    {
                        continue;
                    }
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'X')
                {
                    bAttributeAdded = true;
                    charAttributeChoice = '0';
                }
            }
        }
        else if(strchr("7Gg", charAttributeChoice) != NULL)
        {
            while(bAttributeAdded == false)
            {
                fRetitleConsole(strPrgNme);
                printf("\n");
                printf("Main Menu > Maintain Attributes > Genres");
                printf("\n\n");
                printf("(A)dd, (C)hange, (D)elete, (L)ist, (S)earch or E(x)it: ");
                charAddChangeDeleteListSearchExitChoice = toupper(GetChar());
                if(charAddChangeDeleteListSearchExitChoice == 'A')
                {
                    printf("\n");
                    if(fAddGenre(strPrgNme) == 0)
                    {
                        bAttributeAdded = false;
                    }
                    else
                    {
                        bAttributeAdded = true;
                    }
                    charAttributeChoice = '0';
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'C')
                {
                    printf("\n");
                    fUpdateGenre(strPrgNme);
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'D')
                {
                    fDeleteGenre(strPrgNme);
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'L')
                {
                    printf("\n");
                    fRetitleConsole(strPrgNme);
                    printf("\n");
                    printf("Main Menu > Maintain Attributes > Genres > List");
                    printf("\n\n");
                    fShowAllGenres(pintDisplayPageLength);
                    printf("Press enter to continue ");
                    while(getchar() != '\n')
                    {
                        continue;
                    }
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'S')
                {
                    printf("\n");
                    fRetitleConsole(strPrgNme);
                    printf("\n");
                    printf("Main Menu > Maintain Attributes > Genres > Search");
                    printf("\n\n");
                    printf("Search String or E(x)it: ");
                    strGenreSearch = GetString();
                    if(strstr("xX", strGenreSearch) != NULL)
                    {
                        continue;
                    }
                    fSearchGenres(strGenreSearch);
                    printf("\n");
                    printf("Press enter to continue ");
                    while(getchar() != '\n')
                    {
                        continue;
                    }
                }
                else if(charAddChangeDeleteListSearchExitChoice == 'X')
                {
                    bAttributeAdded = true;
                    charAttributeChoice = '0';
                }
            }
        }
        else if(strchr("8Xx", charAttributeChoice) != NULL)
        {
            bExitAttributes = true;
        }

        fRetitleConsole(strPrgNme);
    }

    return;
}

void fSetOptions(char *strPrgNme, int *pintDisplayPageLength, char *pcharDisplayPageWidth, char *pcharDisplayOrder)
{

    int  charOptionChoice = '0';
    bool bExitOptions = false;
    bool bValidOptionChoice = false;

    fRetitleConsole(strPrgNme);

    while(bExitOptions == false)
    {
        while(charOptionChoice == '0')
        {
            printf("\n");
            printf("Main Menu > Set Options");
            printf("\n");
            printf("\n");
            printf("1. Display (L)ength: %4d", *pintDisplayPageLength);
            printf("\n");
            printf("2. Display (W)idth: %5c", *pcharDisplayPageWidth);
            printf("\n");
            printf("3. List (O)rder: %8c", *pcharDisplayOrder);
            printf("\n");
            printf("4. E(x)it");
            printf("\n\n");
            printf("Choice: ");
            charOptionChoice = GetChar();
            if(strchr("1234LloOxX", charOptionChoice) == NULL)
            {
                charOptionChoice = '0';
            }
        }
        if(strchr("1lL", charOptionChoice) != NULL)
        {
            printf("\n");
            printf("Display Length: ");
            *pintDisplayPageLength = GetInt();
            printf("\n");
            charOptionChoice = '0';
        }
        else if(strchr("2wW", charOptionChoice) != NULL)
        {
            printf("\n");
            while(bValidOptionChoice == false)
            {
                printf("Display Width ((W)ide or (N)arrow): ");
                *pcharDisplayPageWidth = toupper(GetChar());
                if(*pcharDisplayPageWidth == 'W')
                {
                    bValidOptionChoice = true;
                }
                else if(*pcharDisplayPageWidth == 'N')
                {
                    bValidOptionChoice = true;
                } 
                else
                {
                    bValidOptionChoice = false;
                }
            }
            printf("\n");
            bValidOptionChoice = false;
            charOptionChoice = '0';
        }
        else if(strchr("3oO", charOptionChoice) != NULL)
        {
            printf("\n");
            while(bValidOptionChoice == false)
            {
                printf("Display Order ((A)sc or (D)esc): ");
                *pcharDisplayOrder = toupper(GetChar());
                if(*pcharDisplayOrder == 'A')
                {
                    bValidOptionChoice = true;
                }
                else if(*pcharDisplayOrder == 'D')
                {
                    bValidOptionChoice = true;
                } 
                else
                {
                    bValidOptionChoice = false;
                }
            }
            printf("\n");
            bValidOptionChoice = false;
            charOptionChoice = '0';
        }
        else if(strchr("4xX", charOptionChoice) != NULL)
        {
            bExitOptions = true;
        }

        fRetitleConsole(strPrgNme);
    }

    return;
}

int fAddSeries(char *strPrgNme)
{
    char *strSeriesName;

    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};

    MYSQL *conn;

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Add Series");
    printf("\n\n");

    do{
        printf("Series Name or E(x)it: ");
        strSeriesName = GetString();
    }while(strlen(strSeriesName) == 0);

    if(strcmp(strSeriesName, "x") == 0)
    {
        fRetitleConsole(strPrgNme);
        return 0;
    }
    printf("\n");
    sprintf(strSQL, "INSERT INTO `Book Series` (`Series Name`) VALUES('%s')", strSeriesName);

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return 1;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) == 0)
    {
        printf("Series Added: %s", strSeriesName);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
    }
    else
    {
        printf("Series not added - mysql_query failed");
        printf("\n\n");
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return 1;
    }

    fRetitleConsole(strPrgNme);

    mysql_close(conn);
    return 1;
}

int fAddAuthor(char *strPrgNme)
{
    char *strAuthorName = NULL;
    char *strEscapedAuthorName = NULL;
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};

    MYSQL *conn;

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Authors > Add Author");
    printf("\n\n");

    do {
        printf("Author Name or E(x)it: ");
        strAuthorName = GetString();
    }while (strlen(strAuthorName) == 0);
    strEscapedAuthorName = fEscapeSingleQuote(strAuthorName);

    if(strcmp(strAuthorName, "x") == 0)
    {
        fRetitleConsole(strPrgNme);
        return 0;
    }
    printf("\n");
    sprintf(strSQL, "INSERT INTO `Book Authors` (`Author Name`) VALUES('%s')", strEscapedAuthorName);

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return 1;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) == 0)
    {
        printf("Author Added: %s", strAuthorName);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
    }
    else
    {
        printf("Author not added - mysql_query failed");
        printf("\n\n");
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return 1;
    }

    fRetitleConsole(strPrgNme);
    mysql_close(conn);
    return 1;
}

int fAddClassification(char *strPrgNme)
{
    char *strClassificationName;

    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};

    MYSQL *conn;

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Add Classification");
    printf("\n\n");

    do
    {
        printf("Classification Name (or E(x)it: ");
        strClassificationName = GetString();
    } while(strlen(strClassificationName) == 0);

    if(strcmp(strClassificationName, "x") == 0)
    {
        fRetitleConsole(strPrgNme);
        return 0;
    }
    printf("\n");

    sprintf(strSQL, "INSERT INTO `Book Classifications` (`Classification Name`) VALUES('%s')", strClassificationName);

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return 1;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) == 0)
    {
        printf("Classification Added: %s", strClassificationName);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
    }
    else
    {
        printf("Classification not added - mysql_query() failed");
        printf("\n\n");
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return 1;
    }

    fRetitleConsole(strPrgNme);
    mysql_close(conn);
    return 1;
}

int fAddRating(char *strPrgNme)
{
    char *strRatingName;

    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};

    MYSQL *conn;

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Add Rating");
    printf("\n\n");

    do{
        printf("Rating Name or E(x)it: ");
        strRatingName = GetString();
    }while(strlen(strRatingName) == 0);

    if(strcmp(strRatingName, "x") == 0)
    {
        fRetitleConsole(strPrgNme);
        return 0;
    }
    printf("\n");
    sprintf(strSQL, "INSERT INTO `Book Ratings` (`Rating Name`) VALUES('%s')", strRatingName);

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return 1;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) == 0)
    {
        printf("Rating Added: %s", strRatingName);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
    }
    else
    {
        printf("Rating not added - mysql_query failed");
        printf("\n\n");
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return 1;
    }

    fRetitleConsole(strPrgNme);
    mysql_close(conn);
    return 1;
}

int fAddSource(char *strPrgNme)
{
    char *strSourceName;

    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};

    MYSQL *conn;

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Add Source");
    printf("\n\n");

    do
    {
    printf("Source Name or E(x)it: ");
    strSourceName = GetString();
    }while(strlen(strSourceName) == 0);

    if(strcmp(strSourceName, "x") == 0)
    {
        fRetitleConsole(strPrgNme);
        return 0;
    }
    printf("\n");
    sprintf(strSQL, "INSERT INTO `Book Sources` (`Source Name`) VALUES('%s')", strSourceName);

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return 1;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) == 0)
    {
        printf("Source Added: %s", strSourceName);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
    }
    else
    {
        printf("Source not added - mysql_query failed");
        printf("\n\n");
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return 1;
    }

    fRetitleConsole(strPrgNme);
    mysql_close(conn);
    return 1;
}

int fAddStatus(char *strPrgNme)
{
    char *strStatusName;

    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};

    MYSQL *conn;

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Add Status");
    printf("\n\n");

    do{
        printf("Status Name or E(x)it: ");
        strStatusName = GetString();
    }while(strlen(strStatusName) == 0);

    if(strcmp(strStatusName, "x") == 0)
    {
        fRetitleConsole(strPrgNme);
        return 0;
    }
    printf("\n");
    sprintf(strSQL, "INSERT INTO `Book Statuses` (`Status Name`) VALUES('%s')", strStatusName);

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return 1;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) == 0)
    {
        printf("Status Added: %s", strStatusName);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
    }
    else
    {
        printf("Status not added - mysql_query failed");
        printf("\n\n");
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return 1;
    }

    fRetitleConsole(strPrgNme);
    mysql_close(conn);
    return 1;
}

int fAddGenre(char *strPrgNme)
{
    char *strGenreName;
    char *strGenreDesc;

    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};

    MYSQL *conn;

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Add Genre:");
    printf("\n\n");

    do{
        printf("Genre Name or E(x)it: ");
        strGenreName = GetString();
    }while(strlen(strGenreName) == 0);

    if(strcmp(strGenreName, "x") == 0)
    {
        fRetitleConsole(strPrgNme);
        return 0;
    }

    do{
        printf("Genre Description or E(x)it: ");
        strGenreDesc = GetString();
    }while(strlen(strGenreDesc) == 0);

    if(strcmp(strGenreDesc, "x") == 0)
    {
        fRetitleConsole(strPrgNme);
        return 0;
    }

    printf("\n");
    sprintf(strSQL, "INSERT INTO `Book Genres` (`Genre Name`, `Genre Description`) VALUES('%s', '%s')", strGenreName, strGenreDesc);

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return 1;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) == 0)
    {
        printf("Genre Added: %s, %s", strGenreName, strGenreDesc);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
    }
    else
    {
        printf("Genre not added - mysql_query failed");

        printf("\n\n");
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return 1;
    }

    fRetitleConsole(strPrgNme);
    mysql_close(conn);
    return 1;
}

void fAddTitle(char *strPrgNme)
{
    char *strTitleName;
    char *strTitleNameEscaped;
    char *strStartDate;

    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};

    MYSQL *conn;

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Add Title");
    printf("\n\n");


    do {
        printf("Title Name or E(x)it: ");
        strTitleName = GetString();
    } while(strlen(strTitleName) == 0);

    strTitleNameEscaped = fEscapeSingleQuote(strTitleName);
    if(strcmp(strTitleName, "x") == 0)
    {
        fRetitleConsole(strPrgNme);
        return;
    }
    printf("Start Date (YYYY-MM-DD): ");
    strStartDate = GetString();
    printf("\n");
    if(strlen(strStartDate) == 0)
    {
        sprintf(strSQL, "INSERT INTO `Book Titles` (`Title Name`, `Author ID`, `Source ID`, `Series ID`"
                        ", `Genre ID`, `Status ID`, `Classification ID`,"
                        "`Rating ID`, `Start`) VALUES ('%s', 67, 10, 57, 17, 6, 3, 6, null)", strTitleNameEscaped);
    }
    else
    {
        sprintf(strSQL, "INSERT INTO `Book Titles` (`Title Name`, `Author ID`, `Source ID`, `Series ID`"
                        ", `Genre ID`, `Status ID`, `Classification ID`,"
                        "`Rating ID`, `Start`) VALUES ('%s', 67, 10, 57, 17, 6, 3, 6, '%s')", strTitleNameEscaped, strStartDate);
    }
// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) == 0)
    {
        if(strlen(strStartDate) > 0)
        {
            printf("Title Added: %s starting %s", strTitleName, strStartDate);
            printf("\n\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
        }
        else
        {
            printf("Title Added: %s", strTitleName);
            printf("\n\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
        }
    }
    else
    {
        printf("Title not added - mysql_query failed");
        printf("\n\n");
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

    fRetitleConsole(strPrgNme);
    mysql_close(conn);
    return;
}

void fUpdateTitleAndAttributes(char *strPrgNme, int *pintDisplayPageLength)
{
    int  intTitleID = 0;
    int  intMaxTitleID = 0;
    int  intMinTitleID = 0;
    int  intNewAuthorID = 0;
    int  intNewSourceID = 0;
    int  intNewSeriesID = 0;
    int  intNewGenreID = 0;
    int  intNewStatusID = 0;
    int  intNewClassnID = 0;
    int  intNewRatingID = 0;
    bool bExitAttributeChoice = false;
    bool bTitleFound = false;
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};
    char *strTitleName = NULL;
    char *strNewStartDate = NULL;
    char *strNewFinishDate = NULL;
    char *strNewComments = NULL;
    char *strNewCommentsEscaped = NULL;
    char charUpdateTitleAndAttributesAction = 'X';
    char *strTitleSearch = NULL;
    char *strAttribChoice = "00";                                  // choice of attribute to change

    while(bTitleFound == false)
    {
        fRetitleConsole(strPrgNme);

        printf("\n");
        printf("Main Menu > Update a Title and Attributes");
        printf("\n\n");

        printf("(T)itle ID, (S)earch or E(x)it: ");
        charUpdateTitleAndAttributesAction = GetChar();

        if(toupper(charUpdateTitleAndAttributesAction) == 'S')
        {
            printf("\n");
            printf("Search String: ");
            strTitleSearch = GetString();
            fSearchTitles(strTitleSearch);
            printf("\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
        }
        else if(toupper(charUpdateTitleAndAttributesAction) == 'T')
        {
            printf("\n");
            printf("Title ID: ");
            intTitleID = GetInt();
            if(fCheckTitleIDExists(intTitleID) == true)
            {
                bTitleFound = true;
            }
            else
            {
                bTitleFound = false;
            }
            printf("\n");
        }
        else if(toupper(charUpdateTitleAndAttributesAction) == 'X')
        {
            fRetitleConsole(strPrgNme);
            return;
        }
        else
        {
            printf("\n");
            printf("Not a valid choice so exiting");
            bTitleFound = true;
            printf("\n\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
            fRetitleConsole(strPrgNme);
            return;
        }
    }

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    intMaxTitleID = fGetMaxTitleID();
    intMinTitleID = fGetMinTitleID();

    while(bExitAttributeChoice == false)
    {
        while((intTitleID < intMinTitleID) || (intTitleID > intMaxTitleID + 1))
        {
            printf("Title ID (%d - %d): ", intMinTitleID, intMaxTitleID);
            intTitleID = GetInt();
        }

        fRetitleConsole(strPrgNme);
        printf("\n");
        fShowTitle(intTitleID, strPrgNme);
        fShowAttributes(intTitleID);

        while((strstr("12345678910111213tTaAoOeEgGsScCrRdDfFmMxXhH", strAttribChoice) == NULL))
        {
            printf("\n");
            printf("Attribute Number (1-13): ");
            strAttribChoice = GetString();
            printf("\n");
        }

        if(strstr("1tT", strAttribChoice) != NULL)
        {
            printf("New Title Name: ");
            strTitleName = GetString();
            sprintf(strSQL, "UPDATE `Book Titles` SET `Title Name` = '%s' WHERE `Title ID` = %d", strTitleName, intTitleID);
            strcpy(strAttribChoice, "00");
        }
        else if(strstr("2aA", strAttribChoice) != NULL)
        {
            fShowAllAuthors(pintDisplayPageLength);
            printf("New Author ID: ");
            intNewAuthorID = GetInt();
            sprintf(strSQL, "UPDATE `Book Titles` SET `Author ID` = %d WHERE `Title ID` = %d", intNewAuthorID, intTitleID);
            strcpy(strAttribChoice, "00");
        }
        else if(strstr("3Oo", strAttribChoice) != NULL)
        {
            fShowAllSources(pintDisplayPageLength);
            printf("New Source ID: ");
            intNewSourceID = GetInt();
            sprintf(strSQL, "UPDATE `Book Titles` SET `Source ID` = %d WHERE `Title ID` = %d", intNewSourceID, intTitleID);
            strcpy(strAttribChoice, "00");
        }
        else if(strstr("4eE", strAttribChoice) != NULL)
        {
            fShowAllSeries(pintDisplayPageLength);
            printf("New Series ID: ");
            intNewSeriesID = GetInt();
            sprintf(strSQL, "UPDATE `Book Titles` SET `Series ID` = %d WHERE `Title ID` = %d", intNewSeriesID, intTitleID);
            strcpy(strAttribChoice, "00");
        }
        else if(strstr("5gG", strAttribChoice) != NULL)
        {
            fShowAllGenres(pintDisplayPageLength);
            printf("New Genre ID: ");
            intNewGenreID = GetInt();
            sprintf(strSQL, "UPDATE `Book Titles` SET `Genre ID` = %d WHERE `Title ID` = %d", intNewGenreID, intTitleID);
            strcpy(strAttribChoice, "00");
        }
        else if(strstr("6sS", strAttribChoice) != NULL)
        {
            fShowAllStatuses(pintDisplayPageLength);
            printf("New Status ID: ");
            intNewStatusID = GetInt();
            sprintf(strSQL, "UPDATE `Book Titles` SET `Status ID` = %d WHERE `Title ID` = %d", intNewStatusID, intTitleID);
            strcpy(strAttribChoice, "00");
        }
        else if(strstr("7cC", strAttribChoice) != NULL)
        {
            fShowAllClassifications(pintDisplayPageLength);
            printf("New Classn ID: ");
            intNewClassnID = GetInt();
            sprintf(strSQL, "UPDATE `Book Titles` SET `Classification ID` = %d WHERE `Title ID` = %d", intNewClassnID, intTitleID);
            strcpy(strAttribChoice, "00");
        }
        else if(strstr("8rR", strAttribChoice) != NULL)
        {
            fShowAllRatings(pintDisplayPageLength);
            printf("New Rating ID: ");
            intNewRatingID = GetInt();
            sprintf(strSQL, "UPDATE `Book Titles` SET `Rating ID` = %d WHERE `Title ID` = %d", intNewRatingID, intTitleID);
            strcpy(strAttribChoice, "00");
        }
        else if(strstr("9dD", strAttribChoice) != NULL)
        {
            printf("New Start Date (YYYY-MM-DD): ");
            strNewStartDate = GetString();
            if(strlen(strNewStartDate) == 0)
            {
                sprintf(strSQL, "UPDATE `Book Titles` SET `Start` = NULL WHERE `Title ID` = %d", intTitleID);
            }
            else
            {
                sprintf(strSQL, "UPDATE `Book Titles` SET `Start` = '%s' WHERE `Title ID` = %d", strNewStartDate, intTitleID);
            }
            strcpy(strAttribChoice, "00");
        }
        else if(strstr("10fF", strAttribChoice) != NULL)
        {
            printf("New Finish Date (YYYY-MM-DD): ");
            strNewFinishDate = GetString();
            if(strlen(strNewFinishDate) == 0)
            {
                sprintf(strSQL, "UPDATE `Book Titles` SET `Finish` = NULL WHERE `Title ID` = %d", intTitleID);
            }
            else
            {
                sprintf(strSQL, "UPDATE `Book Titles` SET `Finish` = '%s' WHERE `Title ID` = %d", strNewFinishDate, intTitleID);
            }
            strcpy(strAttribChoice, "00");
        }
        else if(strstr("11mM", strAttribChoice) != NULL)
        {
            do{
                printf("New Comments): ");
                strNewComments = GetString();
            }while(strlen(strNewComments) == 0);

            strNewCommentsEscaped = fEscapeSingleQuote(strNewComments);
            sprintf(strSQL, "UPDATE `Book Titles` SET `Comments` = '%s' WHERE `Title ID` = %d", strNewCommentsEscaped, intTitleID);
            strcpy(strAttribChoice, "00");
        }
        else if(strstr("12hH", strAttribChoice) != NULL)
        {
            printf("Show Characters: ");
            printf("\n\n");
            fShowCharacters(intTitleID, strPrgNme);
            sprintf(strSQL, "UPDATE `Book Titles` SET `Comments` = '%s' WHERE `Title ID` = %d", strNewComments, intTitleID);
            strcpy(strAttribChoice, "00");
            printf("\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
        }
        else if(strstr("13xX", strAttribChoice) != NULL)
        {
            bExitAttributeChoice = true;
        }

// initialize a connection and connect to the database

        if(bExitAttributeChoice == false)
        {
            conn = mysql_init(NULL);

            if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
            {
                printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
                printf("\n");
                printf("Press enter to continue ");
                while (getchar() != '\n')
                {
                    continue;
                }
                mysql_close(conn);
                return;
            }

// execute the query and check for no result

            if(mysql_query(conn, strSQL) != 0)
            {
                printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
                printf("\n\n");
                printf("Press enter to continue ");
                while (getchar() != '\n')
                {
                    continue;
                }
                mysql_close(conn);
                return;
            }

// test for a SQL error

            if(*mysql_error(conn))
            {
                printf("\n");
                printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
                printf("\n\n");
                printf("Press enter to continue ");
                while(getchar() != '\n')
                {
                    continue;
                }

                fRetitleConsole(strPrgNme);
                strcpy(strAttribChoice, "00");
            }

            fRetitleConsole(strPrgNme);
        }
    }

    fRetitleConsole(strPrgNme);
    mysql_close(conn);
    return;
}

int  fGetMaxTitleID(void)
{
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};
    char **endptr;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    sprintf(strSQL, "SELECT MAX(`Title ID`) from `Book Titles`");

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return 1;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return 1;

    }

// test for a SQL error

    if(*mysql_error(conn))
    {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }

        (void) system("clear");
        printf("\n");
        
        mysql_close(conn);
        return 1;
    }

// store the result of the query

    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("\n");
        printf("Query failed to return a line of results");
        printf("\n\n");
        printf("Count of rows returned: %d", mysql_field_count(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }

        mysql_free_result(res);
        mysql_close(conn);
        return 0;
    }

// reset the pointer in the result set to zero before fetching rows

    mysql_data_seek(res, 0);

    row = mysql_fetch_row(res);

    mysql_free_result(res);
    mysql_close(conn);
    return(int) strtol(row[0], endptr, 10);
}

int fGetMinTitleID(void)
{
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};
    char **endptr;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    sprintf(strSQL, "SELECT MIN(`Title ID`) from `Book Titles`");

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return 0;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return 0;
    }

// test for a SQL error

    if(*mysql_error(conn))
    {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }

        (void) system("clear");
        printf("\n");
        
        mysql_close(conn);
        return 0;
    }

// store the result of the query

    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("\n");
        printf("Query failed to return a line of results");
        printf("\n\n");
        printf("Count of rows returned: %d", mysql_field_count(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }

        mysql_free_result(res);
        mysql_close(conn);
        return 0;
    }

// reset the pointer in the result set to zero before fetching rows

    mysql_data_seek(res, 0);

    row = mysql_fetch_row(res);

    mysql_free_result(res);
    mysql_close(conn);
    return(int) strtol(row[0], endptr, 10);
}

void fShowAttributes(int intTitleID)
{
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    sprintf(strSQL, "SELECT `Title ID`"
                         ", `Title Name`"
                         ", BT.`Author ID`"
                         ", BA.`Author Name`"
                         ", BT.`Source ID`"
                         ", BS.`Source Name`"
                         ", BT.`Series ID`"
                         ", BE.`Series Name`"
                         ", BT.`Genre ID`"
                         ", BG.`Genre Name`"
                         ", BT.`Status ID`"
                         ", BU.`Status Name`"
                         ", BT.`Classification ID`"
                         ", BC.`Classification Name`"
                         ", BT.`Rating ID`"
                         ", BR.`Rating Name`"
                         ", BT.`Start`"
                         ", BT.`Finish`"
                         ", BT.`Comments`"
                         "FROM `Book Titles` BT LEFT JOIN `Book Authors` BA ON BT.`Author ID` = BA.`Author ID`"
                         "LEFT JOIN `Book Sources` BS ON BT.`Source ID` = BS.`Source ID`"
                         "LEFT JOIN `Book Series` BE ON BT.`Series ID` = BE.`Series ID`"
                         "LEFT JOIN `Book Genres` BG ON BT.`Genre ID` = BG.`Genre ID`"
                         "LEFT JOIN `Book Statuses` BU on BT.`Status ID` = BU.`Status ID`"
                         "LEFT JOIN `Book Classifications` BC ON BT.`Classification ID` = BC.`Classification ID`"
                         "LEFT JOIN `Book Ratings` BR ON BT.`Rating ID` = BR.`Rating ID`"
                         "WHERE `Title ID` = %d", intTitleID); 

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function\n\n%s(): %s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// test for a SQL error

    if(*mysql_error(conn))
    {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }

        printf("fShowAttributes() -- SQL error");
        printf("\n");
        
        mysql_close(conn);
        return;
    }
// store the result of the query

    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");
        
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// reset the pointer in the result set to zero before fetching rows

    mysql_data_seek(res, 0);

// print each row of results

    row = mysql_fetch_row(res);
    printf("\n");
    printf("Update a Title and Attributes");
    printf("\n\n");
    printf(" 1. (T)itle ID:  %3s  %s", row[0] ? row[0] : "", row[1] ? row[1] : "");
    printf("\n");
    printf(" 2. (A)uthor ID: %3s  %s", row[2] ? row[2] : "", row[3] ? row[3] : "");
    printf("\n");
    printf(" 3. S(o)urce ID: %3s  %s", row[4] ? row[4] : "", row[5] ? row[5] : "");
    printf("\n");
    printf(" 4. S(e)ries ID: %3s  %s", row[6] ? row[6] : "", row[7] ? row[7] : "");
    printf("\n");
    printf(" 5. (G)enre ID:  %3s  %s", row[8] ? row[8] : "", row[9] ? row[9] : "");
    printf("\n");
    printf(" 6. (S)tatus ID: %3s  %s", row[10] ? row[10] : "", row[11] ? row[11] : "");
    printf("\n");
    printf(" 7. (C)lassn ID: %3s  %s", row[12] ? row[12] : "", row[13] ? row[13] : "");
    printf("\n");
    printf(" 8. (R)ating ID: %3s  %s", row[14] ? row[14] : "", row[15] ? row[15] : "");
    printf("\n");
    printf(" 9. Start (D)te:      %s", row[16] ? row[16] : "");
    printf("\n");
    printf("10. (F)insh Dte:      %s", row[17] ? row[17] : "");
    printf("\n");
    printf("11. Co(m)ments:       %s", row[18] ? row[18] : "");
    printf("\n");
    printf("12. Show C(h)aracters");
    printf("\n");
    printf("13. E(x)it");
    printf("\n");

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fShowCharacters(int intTitleID, char *strPrgNme)
{
    int *intLengths = NULL;
    int intColCount = 0;
    int intRowsReturned = 0;
    int intRowsPrinted = 0;
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    sprintf(strSQL, "SELECT  `Character ID`, `Character Name` "
                    "FROM `Book Characters` "
                    "WHERE `Title ID` = %d", intTitleID);

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
    }

// test for a SQL error

    if(*mysql_error(conn))
    {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;

        printf("fShowAttributes() -- SQL error");
        printf("\n");
        
        mysql_close(conn);
        return;
    }
// store the result of the query

    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");
        
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// reset the pointer in the result set to zero before fetching rows

    mysql_data_seek(res, 0);

// fetch the number of fields and rows in the result

    intColCount = mysql_num_fields(res);
    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("No characters in Title ID: %d", intTitleID);
        printf("\n");
    }

// fetch the max width of each column

    intLengths = (int *)calloc(intColCount, sizeof(int));

    while((row = mysql_fetch_row(res)) && (intRowsReturned != 0))
    {
        for(int k = 0; k < intColCount; k++)
        {
            if(row[k] != NULL)
            {
                if(strlen(row[k]) > intLengths[k])
                {
                     intLengths[k] = strlen(row[k]);
                }
            }
        }
    }

// reset the  pointer in the result set to zero before fetching rows

    mysql_data_seek(res, 0);

// print each row of results

    while((row = mysql_fetch_row(res)) && (intRowsReturned != 0))
    {
        intRowsPrinted++;
        for(int i = 0; i < intColCount; i++)
        {
            printf("%-*s", intLengths[i] + 1, row[i] ? row[i] : "");
        }
        printf("\n");
    }
    
    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fSearchTitles(char *strSearchString)
{
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};
    int  intColCount = 0;
    int  intRowsReturned = 0;
    int  intRowsPrinted = 0;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    sprintf(strSQL, "SELECT  `Title ID`, `Title Name` "
                    "FROM `Book Titles` "
                    "WHERE `Title Name` LIKE '%%%s%%'", strSearchString);

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
     }
 // store the result of the query
 
     res = mysql_store_result(conn);
     if(res == NULL)
     {
         printf("fShowAttributes() -- No results returned");
         printf("\n");
         
         mysql_free_result(res);
         mysql_close(conn);
         return;
     }

// fetch the number of fields and rows in the result

    intColCount = mysql_num_fields(res);
    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching titles found");
    }

// print each row of results

    printf("\n");
    while((row = mysql_fetch_row(res)) && (intRowsReturned != 0))
    {
        intRowsPrinted++;
        printf("%4s  %s", row[0], row[1]);
        printf("\n");
    }
    
    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fRetitleConsole(char *strPrgNme)
{
    (void) system("clear");
    printf("%s -- Library maintenance using mySQL.", strPrgNme);
    printf("\n");
    return;
}

void fShowAllSources(int *pintDisplayPageLength)
{
    int  intRowCount = 0;
    int  intMaxWidth = 0;
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    sprintf(strSQL, "SELECT S.`Source ID`"
                         ", S.`Source Name` "
                         ", COUNT(T.`Title ID`)"
                   " FROM `Book Sources` S"
                   " LEFT JOIN `Book Titles` T ON S.`Source ID` = T.`Source ID`"
                   " GROUP BY S.`Source ID`, S.`Source Name`"
                   " ORDER BY `Source ID` ASC");

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// test for a SQL error

    if(*mysql_error(conn))
    {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }

        printf("fShowAttributes() -- SQL error");
        printf("\n");
        
        mysql_close(conn);
        return;
    }
// store the result of the query

    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");
        
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// reset the pointer in the result set to zero before fetching rows

    mysql_data_seek(res, 0);

    while(row = mysql_fetch_row(res))
    {
        if(strlen(row[1]) > intMaxWidth)
        {
            intMaxWidth = strlen(row[1]);
        }
    }

    mysql_data_seek(res, 0);

// print each row of results

    printf("Title Sources and Title Counts");
    printf("\n\n");
    while(row = mysql_fetch_row(res))
    {
        intRowCount++;
        printf("%3s  %-*s %3s", row[0], intMaxWidth, row[1], row[2]);
        printf("\n");
        if(intRowCount >= *pintDisplayPageLength)
        {
            printf("\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
            printf("\n");
            intRowCount = 0;
        }

    }
    printf("\n");

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fShowAllGenres(int *pintDisplayPageLength)
{
    int  intRowCount = 0;
    int  intMaxWidth = 0;
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    sprintf(strSQL, "SELECT G.`Genre ID`"
                         ", G. `Genre Name` "
                         ", COUNT(T.`Title ID`)"
                   " FROM `Book Genres` G"
                   " LEFT JOIN `Book Titles` T ON G.`Genre ID` = T.`Genre ID`"
                   " GROUP BY G.`Genre ID`, G.`Genre Name`"
                   " ORDER BY `Genre ID` ASC");

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// test for a SQL error

    if(*mysql_error(conn))
    {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }

        printf("fShowAttributes() -- SQL error");
        printf("\n");
        
        mysql_close(conn);
        return;
    }
// store the result of the query

    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");
        
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// reset the pointer in the result set to zero before fetching rows

    mysql_data_seek(res, 0);

    while(row = mysql_fetch_row(res))
    {
        if(strlen(row[1]) > intMaxWidth)
        {
            intMaxWidth = strlen(row[1]);
        }
    }

    mysql_data_seek(res, 0);

// print each row of results

    printf("Title Genres and Title Counts");
    printf("\n\n");
    while(row = mysql_fetch_row(res))
    {
        intRowCount++;
        printf("%3s  %-*s %3s", row[0], intMaxWidth, row[1], row[2]);
        printf("\n");
        if(intRowCount >= *pintDisplayPageLength)
        {
            printf("\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
            printf("\n");
            intRowCount = 0;
        }
    }
    printf("\n");

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fShowAllStatuses(int *pintDisplayPageLength)
{
    int  intRowCount = 0;
    int  intMaxWidth = 0;
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    sprintf(strSQL, "SELECT S.`Status ID`"
                        ", S.`Status Name`"
                        ", COUNT(T.`Title ID`)"
                   " FROM `Book Statuses` S"
                   " LEFT JOIN `Book Titles` T ON S.`Status ID` = T.`Status ID`"
                   " GROUP BY S.`Status ID`, S.`Status Name`"
                   " ORDER BY `Status ID` ASC");

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// test for a SQL error

    if(*mysql_error(conn))
    {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }

        printf("fShowAttributes() -- SQL error");
        printf("\n");
        
        mysql_close(conn);
        return;
    }
// store the result of the query

    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");
        
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// reset the pointer in the result set to zero before fetching rows

    mysql_data_seek(res, 0);

    while(row = mysql_fetch_row(res))
    {
        if(strlen(row[1]) > intMaxWidth)
        {
            intMaxWidth = strlen(row[1]);
        }
    }

    mysql_data_seek(res, 0);

// print each row of results

    printf("Title Statuses and Title Counts");
    printf("\n\n");
    while(row = mysql_fetch_row(res))
    {
        intRowCount++;
        printf("%3s  %-*s %3s", row[0], intMaxWidth, row[1], row[2]);
        printf("\n");
        if(intRowCount >= *pintDisplayPageLength)
        {
            printf("\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
            printf("\n");
            intRowCount = 0;
        }
    }
    printf("\n");

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fShowAllClassifications(int *pintDisplayPageLength)
{
    int  intRowCount = 0;
    int  intMaxWidth = 0;
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    sprintf(strSQL, "SELECT C.`Classification ID`"
                        " , C.`Classification Name`"
                        " , COUNT(T.`Title ID`)"
                   " FROM `Book Classifications` C"
                   " LEFT JOIN `Book Titles` T ON C.`Classification ID` = T.`Classification ID`"
                   " GROUP BY C.`Classification ID`, C.`Classification Name`"
                    "ORDER BY C.`Classification ID` ASC");

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// test for a SQL error

    if(*mysql_error(conn))
    {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }

        printf("fShowAttributes() -- SQL error");
        printf("\n");
        
        mysql_close(conn);
        return;
    }
// store the result of the query

    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");
        
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// reset the pointer in the result set to zero before fetching rows

    mysql_data_seek(res, 0);

    while(row = mysql_fetch_row(res))
    {
        if(strlen(row[1]) > intMaxWidth)
        {
            intMaxWidth = strlen(row[1]);
        }
    }

    mysql_data_seek(res, 0);

// print each row of results

    printf("Title Classifications and Title Counts");
    printf("\n\n");
    while(row = mysql_fetch_row(res))
    {
        intRowCount++;
        printf("%3s  %-*s %3s", row[0], intMaxWidth, row[1], row[2]);
        printf("\n");
        if(intRowCount >= *pintDisplayPageLength)
        {
            printf("\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
            printf("\n");
            intRowCount = 0;
        }
    }
    printf("\n");

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fShowAllRatings(int  *pintDisplayPageLength)
{
    int  intRowCount = 0;
    int  intMaxWidth = 0;
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    sprintf(strSQL, "SELECT R.`Rating ID`"
                        " , R.`Rating Name` "
                        " , COUNT(T.`Title ID`)"
                   " FROM `Book Ratings` R"
                   " LEFT JOIN `Book Titles` T ON R.`Rating ID` = T.`Rating ID`"
                   " GROUP BY R.`Rating ID`, R.`Rating Name`"
                   " ORDER BY `Rating ID` ASC");

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// test for a SQL error

    if(*mysql_error(conn))
    {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }

        printf("fShowAttributes() -- SQL error");
        printf("\n");
        
        mysql_close(conn);
        return;
    }
// store the result of the query

    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");
        
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// reset the pointer in the result set to zero before fetching rows

    mysql_data_seek(res, 0);

    while(row = mysql_fetch_row(res))
    {
        if(strlen(row[1]) > intMaxWidth)
        {
            intMaxWidth = strlen(row[1]);
        }
    }

    mysql_data_seek(res, 0);


// print each row of results

    printf("Title Ratings and Title Counts");
    printf("\n\n");
    while(row = mysql_fetch_row(res))
    {
        intRowCount++;
        printf("%3s  %-*s %3s", row[0], intMaxWidth, row[1], row[2]);
        printf("\n");
        if(intRowCount >= *pintDisplayPageLength)
        {
            printf("\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
            printf("\n");
            intRowCount = 0;
        }
    }
    printf("\n");

    mysql_free_result(res);
    mysql_close(conn);
    return;
}
void fCharacters(char *strPrgNme)
{

    int intTitleID = 0;
    char charExitOrContinue = 'C';
    char *strCharacterToAdd = NULL;
    char *strCharacterToAddEscaped = NULL;
    char *strCharacterToChange = NULL;
    char *strCharacterToChangeEscaped = NULL;
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char *strTitleSearch = NULL;
    char strSQL[SQL_LEN] = {'\0'};
    char charAddCharacterAction = 'X';
    bool bExitCharacters = false;
    bool bTitleFound = false;
    bool bValidChoice = false;
    char charAction = 'A';
    int  intCharID = 0;


    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    while(bTitleFound == false)
    {
        fRetitleConsole(strPrgNme);

        printf("\n");
        printf("Main Menu > Characters");
        printf("\n\n");

        printf("(T)itle ID, (S)earch or E(x)it: ");
        charAddCharacterAction = GetChar();

        if(toupper(charAddCharacterAction) == 'S')
        {
            printf("\n");
            printf("Search String: ");
            strTitleSearch = GetString();
            fSearchTitles(strTitleSearch);
            printf("\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
            printf("\n");
            charAddCharacterAction = 'T';
        }
        else if(toupper(charAddCharacterAction) == 'T')
        {
            printf("\n");
            printf("Title ID: ");
            intTitleID = GetInt();
            if(fCheckTitleIDExists(intTitleID) == true)
            {
                bTitleFound = true;
            }
            else
            {
                bTitleFound = false;
            }
            printf("\n");
        }
        else if(toupper(charAddCharacterAction) == 'X')
        {
            fRetitleConsole(strPrgNme);
            return;
        }
        else
        {
            printf("\n");
            printf("Not a valid choice so exiting");
            bTitleFound = true;
            printf("\n\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
            fRetitleConsole(strPrgNme);
            return;
        }
    }

    while(bExitCharacters == false)
    {
        while(bValidChoice == false)
        {
            
            fRetitleConsole(strPrgNme);
            printf("\n");
            printf("Main Menu > Characters");
            printf("\n\n");
            printf("Title ID: %d", intTitleID);
            printf("\n\n");

            fShowTitle(intTitleID, strPrgNme);
            printf("\n");
            fShowCharacters(intTitleID, strPrgNme);

            printf("\n");
            printf("(A)dd, (C)hange, (D)elete or E(x)it Characters: ");
            charAction = toupper(GetChar());
            if(strchr("xX", charAction) != NULL)
            {
                fRetitleConsole(strPrgNme);
                return;
            }
            else if(strchr("aA", charAction) != NULL)
            {
                bValidChoice = true;
                printf("\n");

                do{
                    printf("Character Name: ");
                    strCharacterToAdd = GetString();
                }while(strlen(strCharacterToAdd) == 0);

                strCharacterToAddEscaped = fEscapeSingleQuote(strCharacterToAdd);
                sprintf(strSQL, "INSERT INTO `Book Characters` (`Character Name`, `Title ID`) VALUES('%s', %d)", strCharacterToAddEscaped, intTitleID);
            }
            else if(strchr("cC", charAction) != NULL)
            {
                bValidChoice = true;
                printf("\n");
                printf("Character ID: ");
                intCharID = GetInt();
                printf("\n");
                
                do{
                    printf("Character Name: ");
                    strCharacterToChange = GetString();
                }while(strlen(strCharacterToChange) ==0);

                strCharacterToChangeEscaped = fEscapeSingleQuote(strCharacterToChange);
                sprintf(strSQL, "UPDATE `Book Characters` SET `Character Name` = '%s' WHERE `Character ID` = %d" , strCharacterToChangeEscaped, intCharID);
            }
            else if(strchr("dD", charAction) != NULL)
            {
                bValidChoice = true;
                printf("\n");
                printf("Character ID: ");
                intCharID = GetInt();
                sprintf(strSQL, "DELETE FROM `Book Characters` WHERE `Character ID` = %d" , intCharID);
            }
            else
            {
                bValidChoice = false;
            }
        }

        printf("\n");

// initialize a connection and connect to the database

        conn = mysql_init(NULL);

        if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
        {
            printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
            printf("\n");
            printf("Press enter to continue ");
            while (getchar() != '\n')
            {
                continue;
            }
            mysql_close(conn);
            return;
        }

// execute the query and check for no result

        if(mysql_query(conn, strSQL) == 0)
        {
            if(charAction == 'A')
            {
                printf("Character Added.");
                printf("\n");
            }
            else if(charAction == 'C')
            {
                printf("Character Changed.");
                printf("\n");
            }
            else if(charAction == 'D')
            {
                printf("Character Deleted.");
                printf("\n");
            }
        }
        else
        {
            printf("Character not added - mysql_query failed");
        }

        printf("\n");
        printf("E(x)it or (C)ontinue): ");
        charExitOrContinue = GetChar();
        if(toupper(charExitOrContinue) == 'X')
        {
            bExitCharacters = true;
        }
        else if(toupper(charExitOrContinue) == 'C')
        {
            bExitCharacters = false;
            bValidChoice =  false;
        }
    }

    fRetitleConsole(strPrgNme);
    
    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fShowTitle(int intTitleID, char *strPrgNme)
{
    int *intLengths = NULL;
    int intColCount = 0;
    int intRowsReturned = 0;
    int intRowsPrinted = 0;
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    sprintf(strSQL, "SELECT  `Title Name` "
                    "FROM `Book Titles` "
                    "WHERE `Title ID` = %d", intTitleID);

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("Failed in %s to connect to MySQL Server %s\n. Error: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// test for a SQL error

    if(*mysql_error(conn))
    {
        printf("\n");
        printf("SQL Error in function %s():i\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }

        printf("fShowAttributes() -- SQL error");
        printf("\n");
        
        mysql_close(conn);
        return;
    }
// store the result of the query

    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");
        
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// reset the  pointer in the result set to zero before fetching rows

    mysql_data_seek(res, 0);

// fetch the number of fields and rows in the result

    intColCount = mysql_num_fields(res);
    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("No Title Name for the Title ID: %d", intTitleID);
        printf("\n");
    }

// fetch the max width of each column

    intLengths = (int *)calloc(intColCount, sizeof(int));

    while((row = mysql_fetch_row(res)) && (intRowsReturned != 0))
    {
        for(int k = 0; k < intColCount; k++)
        {
            if(row[k] != NULL)
            {
                if(strlen(row[k]) > intLengths[k])
                {
                     intLengths[k] = strlen(row[k]);
                }
            }
        }
    }

// reset the  pointer in the result set to zero before fetching rows

    mysql_data_seek(res, 0);

// print each row of results

    printf("%d ", intTitleID);

    while((row = mysql_fetch_row(res)) && (intRowsReturned != 0))
    {
        intRowsPrinted++;
        for(int i = 0; i < intColCount; i++)
        {
            printf("%-*s", intLengths[i] + 1, row[i] ? row[i] : "");
        }
        printf("\n");
    }
    
    mysql_free_result(res);
    mysql_close(conn);
    return;
}

char *fEscapeSingleQuote(char *strQuery)
{

    int intQueryStrLen = 0;
    int i = 0;
    int j = 0;
    char *strTemp = NULL;

    strTemp =(char *)realloc(strTemp, strlen(strQuery) + 10);

    while(strQuery[i] != '\0')
    {
        strTemp[j] = strQuery[i];
        if(strTemp[j] == '\'')
        {
            j++;
            strTemp[j] = '\'';
        };
        i++;
        j++;
    }
    strcpy(strQuery, strTemp);
    free(strTemp);
    return strQuery;
}

bool fCheckTitleIDExists(int intTitleID)
{
    int intRowsReturned = 0;
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};
    bool bTitleIDFound = false;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    sprintf(strSQL, "SELECT  `Title ID` "
                    "FROM `Book Titles` "
                    "WHERE `Title ID` = %d", intTitleID);

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return false;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
    }

// test for a SQL error

    if(*mysql_error(conn))
    {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }

        printf("fShowAttributes() -- SQL error");
        printf("\n");
        
        bTitleIDFound = false;
    }
// store the result of the query

    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");
        
        bTitleIDFound = false;
    }

// reset the  pointer in the result set to zero before fetching rows

    mysql_data_seek(res, 0);

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No Match for Title ID: %d. ", intTitleID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
        bTitleIDFound = false;
        printf("\n");
    }
    else 
    {
        bTitleIDFound = true;
        printf("\n");
    }
    
    mysql_free_result(res);
    mysql_close(conn);
    return bTitleIDFound;
}

void fShowAllAuthors(int *pintDisplayPageLength)
{
    int  intRowCount = 0;
    int  intMaxWidth = 0;                                // Maximum width of Name colum for printing
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

//    sprintf(strSQL, "SELECT `Author ID`, `Author Name` "
//                    "FROM `Book Authors`"
//                    "ORDER BY `Author ID` ASC");

    sprintf(strSQL, "SELECT A.`Author ID`"
                         ", A.`Author Name` "
                         ", COUNT(T.`Title Name`) "
                    "FROM `Book Authors` A "
                    "LEFT JOIN `Book Titles` T ON A.`Author ID` = T.`Author ID` "
                    "GROUP BY A.`Author ID`, A.`Author Name` "
                    "ORDER BY `Author ID` ASC");

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// test for a SQL error

    if(*mysql_error(conn))
    {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }

        printf("fShowAttributes() -- SQL error");
        printf("\n");
        
        mysql_close(conn);
        return;
    }
// store the result of the query

    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");
        
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// reset the pointer in the result set to zero before fetching rows

    mysql_data_seek(res, 0);

    while(row = mysql_fetch_row(res))
    {
        if(strlen(row[1]) > intMaxWidth)
        {
            intMaxWidth = strlen(row[1]);
        }
    }

    mysql_data_seek(res, 0);

// print each row of results

    printf("Title Authors and Title Counts");
    printf("\n\n");
    while(row = mysql_fetch_row(res))
    {
        intRowCount++;
        printf("%3s  %-*s %3s", row[0], intMaxWidth, row[1], row[2]);
        printf("\n");
        if(intRowCount >= *pintDisplayPageLength) 
        {
            printf("\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
            printf("\n");
            intRowCount = 0;
        }
    }
    printf("\n");

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fShowAllSeries(int *pintDisplayPageLength)
{
    int  intRowCount = 0;
    int  intMaxWidth = 0;
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    sprintf(strSQL, "SELECT E.`Series ID`"
                        " , E.`Series Name` "
                        ",  COUNT(T.`Title ID`)"
                   " FROM `Book Series` E"
                   " LEFT JOIN `Book Titles` T ON E.`Series ID` = T.`Series ID`"
                   " GROUP BY E.`Series ID`, E.`Series Name`"
                   "ORDER BY `Series ID` ASC");
 
// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// test for a SQL error

    if(*mysql_error(conn))
    {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }

        printf("fShowAttributes() -- SQL error");
        printf("\n");

        mysql_close(conn);
        return;
    }
// store the result of the query

    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");
        
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// reset the pointer in the result set to zero before fetching rows

    mysql_data_seek(res, 0);

    while(row = mysql_fetch_row(res))
    {
        if(strlen(row[1]) > intMaxWidth)
        {
            intMaxWidth = strlen(row[1]);
        }
    }

    mysql_data_seek(res, 0);

// print each row of results

    printf("Title Series and Title Counts");
    printf("\n\n");
    while(row = mysql_fetch_row(res))
    {
        intRowCount++;
        printf("%3s  %-*s %3s", row[0], intMaxWidth, row[1], row[2]);
        printf("\n");
        if(intRowCount >= *pintDisplayPageLength) 
        {
            printf("\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
            printf("\n");
            intRowCount = 0;
        }
    }
    printf("\n");

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fListAuthors(char *strPrgNme, int *pintDisplayPageLength, char *pcharDisplayPageWidth, char *pCharDisplayOrder)
{
    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    int intColCount = 0;
    int *intLengths = NULL;
    int intRowCount = 0;
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strOrder[6] = {'D', 'E', 'S', 'C', '\0'};
    char strSQL[SQL_LEN] = {'\0'};
    bool bEndOfPrintBlock = false;

    if(*pCharDisplayOrder == 'A')
    {
        strcpy(strOrder, "ASC");
    }
    else if(*pCharDisplayOrder == 'D')
    {
        strcpy(strOrder, "DESC");
    }
    
    sprintf(strSQL, "SELECT A.`Author ID`"
                    ", A.`Author Name` 'Author'"
                    ", COUNT(T.`Title Name`) 'Count'"
                    "FROM risingfast.`Book Authors` A "
                    "LEFT JOIN risingfast.`Book Titles` T ON A.`Author ID` = T.`Author ID`"
                    "GROUP BY A.`Author ID`"
                    "HAVING COUNT(T.`Title Name`) > 0;");

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > List Authors > Authors and Title Counts");
    printf("\n\n");

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// store the result of the query

    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fListAuthors() -- no results returned");
        printf("\n");

        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// fetch the number of fields in the result

    intColCount = mysql_num_fields(res);

// fetch the max width of each column

    intLengths = (int *)calloc(intColCount, sizeof(int));

    while(row = mysql_fetch_row(res))
    {
        for(int k = 0; k < intColCount; k++)
        {
            if(row[k] != NULL)
            {
                if(strlen(row[k]) > intLengths[k])
                {
                     intLengths[k] = strlen(row[k]);
                }
            }
        }
    }

    mysql_data_seek(res, 0);

// print each row of results

    while(row = mysql_fetch_row(res))
    {
        intRowCount++;
        bEndOfPrintBlock = false;
        for(int i = 0; i < intColCount; i++)
        if((i==0) || (i==2))
        {
            printf("%*s", intLengths[i] + 1, row[i] ? row[i] : "");
        }
        else
        {
            printf("  %-*s", intLengths[i] + 1, row[i] ? row[i] : "");
        }
        printf("\n");
        if(intRowCount >= *pintDisplayPageLength)
        {
            printf("\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
            bEndOfPrintBlock = true;
            printf("\n");
            intRowCount = 0;
        }
    }
    
    free(intLengths);
    
    printf("\n");
    if(bEndOfPrintBlock == false)
    {
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
    }

    fRetitleConsole(strPrgNme);

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fSearchAuthors(char *strSearchString)
{
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};
    int  intColCount = 0;
    int  intRowsReturned = 0;
    int  intRowsPrinted = 0;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    sprintf(strSQL, "SELECT  `Author ID`, `Author Name` "
                    "FROM `Book Authors` "
                    "WHERE `Author Name` LIKE '%%%s%%'", strSearchString);

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
         mysql_close(conn);
         return;
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
         printf("fShowAttributes() -- SQL error");
         printf("\n");
         
         mysql_close(conn);
         return;
     }
 // store the result of the query
 
     res = mysql_store_result(conn);
     if(res == NULL)
     {
         printf("fShowAttributes() -- No results returned");
         printf("\n");
         
         mysql_free_result(res);
         mysql_close(conn);
         return;
     }

// fetch the number of fields and rows in the result

    intColCount = mysql_num_fields(res);
    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching authors found");
    }

// print each row of results

    printf("\n");
    while((row = mysql_fetch_row(res)) && (intRowsReturned != 0))
    {
        intRowsPrinted++;
        printf("%-4s  %s", row[0], row[1]);
        printf("\n");
    }
    
    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fDeleteAuthor(char *strPrgNme)
{

    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};
    int  intRowsReturned = 0;
    int  intAuthorID = 0;
    bool bAuthorExists = false;
    bool bTitlesExist = false;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

// retitle the console

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Authors > Delete");
    printf("\n\n");

// get an Author ID to delete

    printf("Author ID: ");
    intAuthorID = GetInt();

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query to check if the Author ID exists

    sprintf(strSQL, "SELECT `Author ID` FROM `Book Authors` "
                    "WHERE `Author ID` = %d", intAuthorID);


    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
         mysql_close(conn);
         return;
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
         printf("fShowAttributes() -- SQL error");
         printf("\n");
         
         mysql_close(conn);
         return;
     }
    
 // store the result of the query
 
     res = mysql_store_result(conn);
     if(res == NULL)
     {
         printf("fShowAttributes() -- No results returned");
         printf("\n");
         
         mysql_free_result(res);
         mysql_close(conn);
         return;
     }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching Author ID: %d", intAuthorID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
        bAuthorExists = false;
    }
    else
    {
        bAuthorExists = true;
    }

// execute a query to check if the author has titles

    sprintf(strSQL, "SELECT `Title ID` FROM `Book Titles` "
                    "WHERE `Author ID` = %d", intAuthorID);

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
        printf("fShowAttributes() -- SQL error");
        printf("\n");
         
        mysql_free_result(res);
        mysql_close(conn);
        return;
     }
    
 // store the result of the query
 
     res = mysql_store_result(conn);
     if(res == NULL)
     {
         printf("fShowAttributes() -- No results returned");
         printf("\n");
         
         mysql_free_result(res);
         mysql_close(conn);
         return;
     }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned > 0)
    {
        bTitlesExist = true;
        printf("\n");
        printf("Titles exists for Author ID: %d", intAuthorID);
        printf("\n\n");
        printf("Author will not be deleted");
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
    }
    else
    {
        bTitlesExist = false;
    }

// execute a query to delete the author if the author exists and has no titles

    if((bTitlesExist == false) && (bAuthorExists == true))
    {
        sprintf(strSQL, "DELETE FROM `Book Authors` "
                        "WHERE `Author ID` = %d", intAuthorID);

        if(mysql_query(conn, strSQL) != 0)
        {
            printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
            printf("\n\n");
            printf("Press enter to continue ");
            while (getchar() != '\n')
            {
                continue;
            }

        mysql_free_result(res);
        mysql_close(conn);
        return;
        }

// test for a SQL error

        if(*mysql_error(conn))
        {
            printf("\n");
            printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
            printf("\n\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
 
            printf("fShowAttributes() -- SQL error");
            printf("\n");
         
        }

        printf("\n");
        printf("Author ID: %d deleted", intAuthorID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
     }

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fSearchSeries(char *strSearchString)
{
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};
    int  intColCount = 0;
    int  intRowsReturned = 0;
    int  intRowsPrinted = 0;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    sprintf(strSQL, "SELECT  `Series ID`, `Series Name` "
                    "FROM `Book Series` "
                    "WHERE `Series Name` LIKE '%%%s%%'", strSearchString);

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
        printf("fShowAttributes() -- SQL error");
        printf("\n");
         
        mysql_close(conn);
        return;
     }
 // store the result of the query
 
    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");
         
        mysql_free_result(res);
        mysql_close(conn);
        return;

     }

// fetch the number of fields and rows in the result

    intColCount = mysql_num_fields(res);
    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching series found");
    }

// print each row of results

    printf("\n");
    while((row = mysql_fetch_row(res)) && (intRowsReturned != 0))
    {
        intRowsPrinted++;
        printf("%-4s  %s", row[0], row[1]);
        printf("\n");
    }
    
    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fDeleteSeries(char *strPrgNme)
{

    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};
    int  intRowsReturned = 0;
    int  intSeriesID = 0;
    bool bSeriesExists = false;
    bool bTitlesExist = false;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

// retitle the console

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Series > Delete");
    printf("\n\n");

// get an Author ID to delete

    printf("Series ID: ");
    intSeriesID = GetInt();

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query to check if the Author ID exists

    sprintf(strSQL, "SELECT `Series ID` FROM `Book Series` "
                    "WHERE `Series ID` = %d", intSeriesID);

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// test for a SQL error

    if(*mysql_error(conn))
    {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
        printf("fShowAttributes() -- SQL error");
        printf("\n");

        mysql_close(conn);
        return;
    }

 // store the result of the query
 
     res = mysql_store_result(conn);
     if(res == NULL)
     {
        printf("fShowAttributes() -- No results returned");
        printf("\n");
        
        mysql_free_result(res);
        mysql_close(conn);
        return;
     }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching Series ID: %d", intSeriesID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
        bSeriesExists = false;
    }
    else
    {
        bSeriesExists = true;
    }

// execute a query to check if the author has titles

    sprintf(strSQL, "SELECT `Title ID` FROM `Book Titles` "
                    "WHERE `Series ID` = %d", intSeriesID);

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// test for a SQL error

    if(*mysql_error(conn))
    {
       printf("\n");
       printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
       printf("\n\n");
       printf("Press enter to continue ");
       while(getchar() != '\n')
       {
           continue;
       }

        printf("fShowAttributes() -- SQL error");
        printf("\n");
        
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }
    
 // store the result of the query
 
    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");
        
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned > 0)
    {
        bTitlesExist = true;
        printf("\n");
        printf("Titles exists for Series ID: %d", intSeriesID);
        printf("\n\n");
        printf("Series will not be deleted");
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
    }
    else
    {
        bTitlesExist = false;
    }

// execute a query to delete the author if the author exists and has no titles

    if((bTitlesExist == false) && (bSeriesExists == true))
    {
        sprintf(strSQL, "DELETE FROM `Book Series` "
                        "WHERE `Series ID` = %d", intSeriesID);

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// test for a SQL error

        if(*mysql_error(conn))
        {
            printf("\n");
            printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
            printf("\n\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
 
            printf("fShowAttributes() -- SQL error");
            printf("\n");
         
        }

        printf("\n");
        printf("Series ID: %d deleted", intSeriesID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
     }

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fDeleteGenre(char *strPrgNme)
{

    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};
    int  intRowsReturned = 0;
    int  intGenreID = 0;
    bool bGenreExists = false;
    bool bTitlesExist = false;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

// retitle the console

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Genre > Delete");
    printf("\n\n");

// get an Author ID to delete

    printf("Genre ID: ");
    intGenreID = GetInt();

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query to check if the Author ID exists

    sprintf(strSQL, "SELECT `Genre ID` FROM `Book Genres` "
                    "WHERE `Genre ID` = %d", intGenreID);

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
         mysql_close(conn);
         return;
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
         printf("fShowAttributes() -- SQL error");
         printf("\n");

         mysql_close(conn);
         return;
     }
    
 // store the result of the query
 
     res = mysql_store_result(conn);
     if(res == NULL)
     {
         printf("fShowAttributes() -- No results returned");
         printf("\n");
         
         mysql_free_result(res);
         mysql_close(conn);
         return;
     }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching Genre ID: %d", intGenreID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
        bGenreExists = false;
    }
    else
    {
        bGenreExists = true;
    }

// execute a query to check if the author has titles

    sprintf(strSQL, "SELECT `Title ID` FROM `Book Titles` "
                    "WHERE `Genre ID` = %d", intGenreID);

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// test for a SQL error

    if(*mysql_error(conn))
    {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }

        printf("fShowAttributes() -- SQL error");
        printf("\n");

        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

 // store the result of the query

    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");

        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned > 0)
    {
        bTitlesExist = true;
        printf("\n");
        printf("Titles exists for Genre ID: %d", intGenreID);
        printf("\n\n");
        printf("Genre will not be deleted");
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
    }
    else
    {
        bTitlesExist = false;
    }

// execute a query to delete the author if the author exists and has no titles

    if((bTitlesExist == false) && (bGenreExists == true))
    {
        sprintf(strSQL, "DELETE FROM `Book Genres` "
                        "WHERE `Genre ID` = %d", intGenreID);

     if(mysql_query(conn, strSQL) != 0)
     {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_free_result(res);
        mysql_close(conn);
        return;
     }

// test for a SQL error

        if(*mysql_error(conn))
        {
            printf("\n");
            printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
            printf("\n\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
 
            printf("fShowAttributes() -- SQL error");
            printf("\n");
         
        }

        printf("\n");
        printf("Genre ID: %d deleted", intGenreID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
     }

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fSearchGenres(char *strSearchString)
{
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};
    int  intColCount = 0;
    int  intRowsReturned = 0;
    int  intRowsPrinted = 0;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    sprintf(strSQL, "SELECT  `Genre ID`, `Genre Name` "
                    "FROM `Book Genres` "
                    "WHERE `Genre Name` LIKE '%%%s%%'", strSearchString);

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// test for a SQL error

    if(*mysql_error(conn))
    {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
        printf("fShowAttributes() -- SQL error");
        printf("\n");
         
        mysql_close(conn);
        return;
    }
 // store the result of the query

    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");

        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// fetch the number of fields and rows in the result

    intColCount = mysql_num_fields(res);
    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching Genre found");
    }

// print each row of results

    printf("\n");
    while((row = mysql_fetch_row(res)) && (intRowsReturned != 0))
    {
        intRowsPrinted++;
        printf("%-4s  %s", row[0], row[1]);
        printf("\n");
    }
    
    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fDeleteSource(char *strPrgNme)
{

    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};
    int  intRowsReturned = 0;
    int  intSourceID = 0;
    bool bSourceExists = false;
    bool bTitlesExist = false;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

// retitle the console

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Source > Delete");
    printf("\n\n");

// get an Author ID to delete

    printf("Source ID: ");
    intSourceID = GetInt();

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query to check if the Author ID exists

    sprintf(strSQL, "SELECT `Source ID` FROM `Book Sources` "
                    "WHERE `Source ID` = %d", intSourceID);

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
        printf("fShowAttributes() -- SQL error");
        printf("\n");

        mysql_close(conn);
        return;
     }
    
// store the result of the query
 
    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");
         
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching Source ID: %d", intSourceID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
        bSourceExists = false;
    }
    else
    {
        bSourceExists = true;
    }

// execute a query to check if the author has titles

    sprintf(strSQL, "SELECT `Title ID` FROM `Book Titles` "
                    "WHERE `Source ID` = %d", intSourceID);

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
        printf("fShowAttributes() -- SQL error");
        printf("\n");
         
        mysql_free_result(res);
        mysql_close(conn);
        return;
     }
    
 // store the result of the query
 
    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");

        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned > 0)
    {
        bTitlesExist = true;
        printf("\n");
        printf("Titles exists for Source ID: %d", intSourceID);
        printf("\n\n");
        printf("Source will not be deleted");
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
    }
    else
    {
        bTitlesExist = false;
    }

// execute a query to delete the author if the author exists and has no titles

    if((bTitlesExist == false) && (bSourceExists == true))
    {
        sprintf(strSQL, "DELETE FROM `Book Sources` "
                        "WHERE `Source ID` = %d", intSourceID);

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// test for a SQL error

        if(*mysql_error(conn))
        {
            printf("\n");
            printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
            printf("\n\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
 
            printf("fShowAttributes() -- SQL error");
            printf("\n");
         
        }

        printf("\n");
        printf("Source ID: %d deleted", intSourceID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
     }

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fSearchSources(char *strSearchString)
{
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};
    int  intColCount = 0;
    int  intRowsReturned = 0;
    int  intRowsPrinted = 0;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    sprintf(strSQL, "SELECT  `Source ID`, `Source Name` "
                    "FROM `Book Sources` "
                    "WHERE `Source Name` LIKE '%%%s%%'", strSearchString);

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
    }

// test for a SQL error

    if(*mysql_error(conn))
    {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
        printf("fShowAttributes() -- SQL error");
        printf("\n");

        mysql_close(conn);
        return;
    }
 // store the result of the query
 
    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");
         
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// fetch the number of fields and rows in the result

    intColCount = mysql_num_fields(res);
    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching Sources found");
    }

// print each row of results

    printf("\n");
    while((row = mysql_fetch_row(res)) && (intRowsReturned != 0))
    {
        intRowsPrinted++;
        printf("%-4s  %s", row[0], row[1]);
        printf("\n");
    }
    
    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fDeleteRating(char *strPrgNme)
{

    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};
    int  intRowsReturned = 0;
    int  intRatingID = 0;
    bool bRatingExists = false;
    bool bTitlesExist = false;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

// retitle the console

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Rating > Delete");
    printf("\n\n");

// get an Author ID to delete

    printf("Rating ID: ");
    intRatingID = GetInt();

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query to check if the Rating ID exists

    sprintf(strSQL, "SELECT `Rating ID` FROM `Book Ratings` "
                    "WHERE `Rating ID` = %d", intRatingID);

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// test for a SQL error

    if(*mysql_error(conn))
    {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
        printf("fShowAttributes() -- SQL error");
        printf("\n");
         
        mysql_close(conn);
        return;
    }
    
 // store the result of the query
 
    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");
         
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching Rating ID: %d", intRatingID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
        bRatingExists = false;
    }
    else
    {
        bRatingExists = true;
    }

// execute a query to check if the rating has titles

    sprintf(strSQL, "SELECT `Title ID` FROM `Book Titles` "
                    "WHERE `Rating ID` = %d", intRatingID);

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// test for a SQL error

    if(*mysql_error(conn))
    {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
        printf("fShowAttributes() -- SQL error");
        printf("\n");
         
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }
    
 // store the result of the query
 
    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");
         
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned > 0)
    {
        bTitlesExist = true;
        printf("\n");
        printf("Titles exists for Rating ID: %d", intRatingID);
        printf("\n\n");
        printf("Rating will not be deleted");
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
    }
    else
    {
        bTitlesExist = false;
    }

// execute a query to delete the author if the author exists and has no titles

    if((bTitlesExist == false) && (bRatingExists == true))
    {
        sprintf(strSQL, "DELETE FROM `Book Ratings` "
                        "WHERE `Rating ID` = %d", intRatingID);

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
    }

// test for a SQL error

        if(*mysql_error(conn))
        {
            printf("\n");
            printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
            printf("\n\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
 
            printf("fShowAttributes() -- SQL error");
            printf("\n");
         
        }

        printf("\n");
        printf("Rating ID: %d deleted", intRatingID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
     }

    mysql_free_result(res);
    mysql_close(conn);
    return;
}


void fSearchRatings(char *strSearchString)
{
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};
    int  intColCount = 0;
    int  intRowsReturned = 0;
    int  intRowsPrinted = 0;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    sprintf(strSQL, "SELECT  `Rating ID`, `Rating Name` "
                    "FROM `Book Ratings` "
                    "WHERE `Rating Name` LIKE '%%%s%%'", strSearchString);

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
         mysql_close(conn);
         return;
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
         printf("fShowAttributes() -- SQL error");
         printf("\n");
         
         mysql_close(conn);
         return;
     }
 // store the result of the query
 
     res = mysql_store_result(conn);
     if(res == NULL)
     {
         printf("fShowAttributes() -- No results returned");
         printf("\n");
        
         mysql_free_result(res);
         mysql_close(conn);
         return;
     }

// fetch the number of fields and rows in the result

    intColCount = mysql_num_fields(res);
    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching Ratings found");
    }

// print each row of results

    printf("\n");
    while((row = mysql_fetch_row(res)) && (intRowsReturned != 0))
    {
        intRowsPrinted++;
        printf("%-4s  %s", row[0], row[1]);
        printf("\n");
    }
    
    mysql_free_result(res);
    mysql_close(conn);
    return;
}


void fDeleteStatus(char *strPrgNme)
{

    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};
    int  intRowsReturned = 0;
    int  intStatusID = 0;
    bool bStatusExists = false;
    bool bTitlesExist = false;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

// retitle the console

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Status > Delete");
    printf("\n\n");

// get an Author ID to delete

    printf("Status ID: ");
    intStatusID = GetInt();

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query to check if the Author ID exists

    sprintf(strSQL, "SELECT `Status ID` FROM `Book Statuses` "
                    "WHERE `Status ID` = %d", intStatusID);

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
         printf("fShowAttributes() -- SQL error");
         printf("\n");
         
         mysql_close(conn);
         return;
     }
    
 // store the result of the query
 
    res = mysql_store_result(conn);
    if(res == NULL)
    {
        printf("fShowAttributes() -- No results returned");
        printf("\n");

        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching Status ID: %d", intStatusID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
        bStatusExists = false;
    }
    else
    {
        bStatusExists = true;
    }

// execute a query to check if the author has titles

    sprintf(strSQL, "SELECT `Title ID` FROM `Book Titles` "
                    "WHERE `Status ID` = %d", intStatusID);

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_free_result(res);
        mysql_close(conn);
        return;
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }

        printf("fShowAttributes() -- SQL error");
        printf("\n");

        mysql_free_result(res);
        mysql_close(conn);
        return;
     }

 // store the result of the query

     res = mysql_store_result(conn);
     if(res == NULL)
     {
         printf("fShowAttributes() -- No results returned");
         printf("\n");

         mysql_free_result(res);
         mysql_close(conn);
         return;
     }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned > 0)
    {
        bTitlesExist = true;
        printf("\n");
        printf("Titles exists for Status ID: %d", intStatusID);
        printf("\n\n");
        printf("Status will not be deleted");
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
    }
    else
    {
        bTitlesExist = false;
    }

// execute a query to delete the author if the author exists and has no titles

    if((bTitlesExist == false) && (bStatusExists == true))
    {
        sprintf(strSQL, "DELETE FROM `Book Statuses` "
                        "WHERE `Status ID` = %d", intStatusID);

        if(mysql_query(conn, strSQL) != 0)
        {
            printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
            printf("\n\n");
            printf("Press enter to continue ");
            while (getchar() != '\n')
            {
                continue;
            }
        }

// test for a SQL error

        if(*mysql_error(conn))
        {
            printf("\n");
            printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
            printf("\n\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
 
            printf("fShowAttributes() -- SQL error");
            printf("\n");
        }

        printf("\n");
        printf("Status ID: %d deleted", intStatusID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
     }

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fSearchStatuses(char *strSearchString)
{
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};
    int  intColCount = 0;
    int  intRowsReturned = 0;
    int  intRowsPrinted = 0;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    sprintf(strSQL, "SELECT  `Status ID`, `Status Name` "
                    "FROM `Book Statuses` "
                    "WHERE `Status Name` LIKE '%%%s%%'", strSearchString);

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
         printf("fShowAttributes() -- SQL error");
         printf("\n");
         
         mysql_close(conn);
         return;
     }
 // store the result of the query
 
     res = mysql_store_result(conn);
     if(res == NULL)
     {
         printf("fShowAttributes() -- No results returned");
         printf("\n");
         
         mysql_free_result(res);
         mysql_close(conn);
         return;
     }

// fetch the number of fields and rows in the result

    intColCount = mysql_num_fields(res);
    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching Status found");
    }

// print each row of results

    printf("\n");
    while((row = mysql_fetch_row(res)) && (intRowsReturned != 0))
    {
        intRowsPrinted++;
        printf("%-4s  %s", row[0], row[1]);
        printf("\n");
    }
    
    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fDeleteClassification(char *strPrgNme)
{

    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};
    int  intRowsReturned = 0;
    int  intClassificationID = 0;
    bool bClassificationExists = false;
    bool bTitlesExist = false;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

// retitle the console

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Classifications > Delete");
    printf("\n\n");

// get an Author ID to delete

    printf("Classification ID: ");
    intClassificationID = GetInt();

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query to check if the Author ID exists

    sprintf(strSQL, "SELECT `Classification ID` FROM `Book Classifications` "
                    "WHERE `Classification ID` = %d", intClassificationID);

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
         mysql_close(conn);
         return;
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
         printf("fShowAttributes() -- SQL error");
         printf("\n");
         
         mysql_close(conn);
         return;
     }
    
 // store the result of the query
 
     res = mysql_store_result(conn);
     if(res == NULL)
     {
         printf("fShowAttributes() -- No results returned");
         printf("\n");
         
         mysql_free_result(res);
         mysql_close(conn);
         return;
     }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching Classification ID: %d", intClassificationID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
        bClassificationExists = false;
    }
    else
    {
        bClassificationExists = true;
    }

// execute a query to check if the author has titles

    sprintf(strSQL, "SELECT `Title ID` FROM `Book Titles` "
                    "WHERE `Classification ID` = %d", intClassificationID);

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
         printf("fShowAttributes() -- SQL error");
         printf("\n");
        
         mysql_free_result(res);
         mysql_close(conn);
         return;
     }
    
 // store the result of the query
 
     res = mysql_store_result(conn);
     if(res == NULL)
     {
         printf("fShowAttributes() -- No results returned");
         printf("\n");
         
         mysql_free_result(res);
         mysql_close(conn);
         return;
     }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned > 0)
    {
        bTitlesExist = true;
        printf("\n");
        printf("Titles exists for Classification ID: %d", intClassificationID);
        printf("\n\n");
        printf("Classification will not be deleted");
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
    }
    else
    {
        bTitlesExist = false;
    }

// execute a query to delete the author if the author exists and has no titles

    if((bTitlesExist == false) && (bClassificationExists == true))
    {
        sprintf(strSQL, "DELETE FROM `Book Classifications` "
                        "WHERE `Classification ID` = %d", intClassificationID);

        if(mysql_query(conn, strSQL) != 0)
        {
            printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
            printf("\n\n");
            printf("Press enter to continue ");
            while (getchar() != '\n')
            {
                continue;
            }
        }

// test for a SQL error

        if(*mysql_error(conn))
        {
            printf("\n");
            printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
            printf("\n\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
 
            printf("fShowAttributes() -- SQL error");
            printf("\n");
        }

        printf("\n");
        printf("Classification ID: %d deleted", intClassificationID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
     }

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fSearchClassifications(char *strSearchString)
{
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char strSQL[SQL_LEN] = {'\0'};
    int  intColCount = 0;
    int  intRowsReturned = 0;
    int  intRowsPrinted = 0;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

    sprintf(strSQL, "SELECT  `Classification ID`, `Classification Name` "
                    "FROM `Book Classifications` "
                    "WHERE `Classification Name` LIKE '%%%s%%'", strSearchString);

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query and check for no result

    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
         printf("fShowAttributes() -- SQL error");
         printf("\n");

         mysql_close(conn);
         return;
     }
 // store the result of the query
 
     res = mysql_store_result(conn);
     if(res == NULL)
     {
         printf("fShowAttributes() -- No results returned");
         printf("\n");
         
         mysql_free_result(res);
         mysql_close(conn);
         return;
     }

// fetch the number of fields and rows in the result

    intColCount = mysql_num_fields(res);
    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching Classification found");
    }

// print each row of results

    printf("\n");
    while((row = mysql_fetch_row(res)) && (intRowsReturned != 0))
    {
        intRowsPrinted++;
        printf("%-4s  %s", row[0], row[1]);
        printf("\n");
    }
    
    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fUpdateAuthor(char *strPrgNme)
{
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char *strAuthorName = NULL;
    char *strEscapedAuthorName = NULL;
    char strSQL[SQL_LEN] = {'\0'};
    int  intRowsReturned = 0;
    int  intAuthorID = 0;
    bool bAuthorExists = false;
    bool bTitlesExist = false;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

// retitle the console

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Authors > Change");
    printf("\n\n");

// get an Author ID to change

    printf("Author ID: ");
    intAuthorID = GetInt();

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query to check if the Author ID exists

    sprintf(strSQL, "SELECT `Author ID`"
                         ", `Author Name`"
                    "FROM `Book Authors` "
                    "WHERE `Author ID` = %d", intAuthorID);


    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
         mysql_close(conn);
         return;
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
        printf("%s() -- SQL error", __func__);
        printf("\n");
         
        mysql_close(conn);
        return;
     }
    
 // store the result of the query
 
     res = mysql_store_result(conn);
     if(res == NULL)
     {
         printf("%s() -- No results returned", __func__);
         printf("\n");
         
         mysql_free_result(res);
         mysql_close(conn);
         return;
     }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching Author ID: %d", intAuthorID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
        bAuthorExists = false;
    }
    else
    {
        bAuthorExists = true;
        row = mysql_fetch_row(res);
        printf("\n");
        printf("Author Name: %s", row[1]);
        printf("\n\n");
        printf("Changed Author Name: ");
        strAuthorName = fEscapeSingleQuote(GetString());
    }

// execute a query to change the author if the author exists

    if((bTitlesExist == false) && (bAuthorExists == true))
    {
        sprintf(strSQL, "UPDATE `Book Authors`"
                       " SET `Author Name` = '%s'"
                       " WHERE `Author ID` = %d", strAuthorName, intAuthorID);

        if(mysql_query(conn, strSQL) != 0)
        {
            printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
            printf("\n\n");
            printf("Press enter to continue ");
            while (getchar() != '\n')
            {
                continue;
            }
        } else
        {
            printf("\n");
            printf("Author ID: %d updated", intAuthorID);
            printf("\n\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
        }
    }

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fUpdateClassification(char *strPrgNme)
{
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char *strClassificationName = NULL;
    char strSQL[SQL_LEN] = {'\0'};
    int  intRowsReturned = 0;
    int  intClassificationID = 0;
    bool bClassificationExists = false;
    bool bTitlesExist = false;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

// retitle the console

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Classifications > Change");
    printf("\n\n");

// get an Classification ID to delete

    printf("Classification ID: ");
    intClassificationID = GetInt();

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query to check if the Classification ID exists

    sprintf(strSQL, "SELECT `Classification ID`"
                         ", `Classification Name`"
                    "FROM `Book Classifications` "
                    "WHERE `Classification ID` = %d", intClassificationID);


    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
        printf("%s() -- SQL error", __func__);
        printf("\n");
         
        mysql_close(conn);
        return;
     }
    
 // store the result of the query
 
     res = mysql_store_result(conn);
     if(res == NULL)
     {
         printf("%s() -- No results returned", __func__);
         printf("\n");
         
         mysql_free_result(res);
         mysql_close(conn);
         return;
     }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching Classification ID: %d", intClassificationID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
        bClassificationExists = false;
    }
    else
    {
        bClassificationExists = true;
        row = mysql_fetch_row(res);
        printf("\n");
        printf("Classification Name: %s", row[1]);
        printf("\n\n");
        printf("Changed Classification Name: ");
        strClassificationName = GetString();
    }

// execute a query to change the classification if the classification exists

    if((bTitlesExist == false) && (bClassificationExists == true))
    {
        sprintf(strSQL, "UPDATE `Book Classifications`"
                       " SET `Classification Name` = '%s'"
                       " WHERE `Classification ID` = %d", strClassificationName, intClassificationID);

        if(mysql_query(conn, strSQL) != 0)
        {
            printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
            printf("\n\n");
            printf("Press enter to continue ");
            while (getchar() != '\n')
            {
                continue;
            }
        } else
        {
            printf("\n");
            printf("Classification ID: %d updated", intClassificationID);
            printf("\n\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
        }
    }

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fUpdateRating(char *strPrgNme)
{
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char *strRatingName = NULL;
    char strSQL[SQL_LEN] = {'\0'};
    int  intRowsReturned = 0;
    int  intRatingID = 0;
    bool bRatingExists = false;
    bool bTitlesExist = false;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

// retitle the console

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Ratings > Change");
    printf("\n\n");

// get an Rating ID to delete

    printf("Rating ID: ");
    intRatingID = GetInt();

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query to check if the Rating ID exists

    sprintf(strSQL, "SELECT `Rating ID`"
                         ", `Rating Name`"
                    "FROM `Book Ratings` "
                    "WHERE `Rating ID` = %d", intRatingID);


    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
        printf("%s() -- SQL error", __func__);
        printf("\n");
         
        mysql_close(conn);
        return;
     }
    
 // store the result of the query
 
     res = mysql_store_result(conn);
     if(res == NULL)
     {
         printf("%s() -- No results returned", __func__);
         printf("\n");
         
         mysql_free_result(res);
         mysql_close(conn);
         return;
     }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching Rating ID: %d", intRatingID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
        bRatingExists = false;
    }
    else
    {
        bRatingExists = true;
        row = mysql_fetch_row(res);
        printf("\n");
        printf("Rating Name: %s", row[1]);
        printf("\n\n");
        printf("Changed Rating Name: ");
        strRatingName = GetString();
    }

// execute a query to change the rating if the rating exists

    if((bTitlesExist == false) && (bRatingExists == true))
    {
        sprintf(strSQL, "UPDATE `Book Ratings`"
                       " SET `Rating Name` = '%s'"
                       " WHERE `Rating ID` = %d", strRatingName, intRatingID);

        if(mysql_query(conn, strSQL) != 0)
        {
            printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
            printf("\n\n");
            printf("Press enter to continue ");
            while (getchar() != '\n')
            {
                continue;
            }
        } else
        {
            printf("\n");
            printf("Rating ID: %d updated", intRatingID);
            printf("\n\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
        }
    }

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fUpdateSeries(char *strPrgNme)
{
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char *strSeriesName = NULL;
    char strSQL[SQL_LEN] = {'\0'};
    int  intRowsReturned = 0;
    int  intSeriesID = 0;
    bool bSeriesExists = false;
    bool bTitlesExist = false;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

// retitle the console

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Series > Change");
    printf("\n\n");

// get an Series ID to delete

    printf("Series ID: ");
    intSeriesID = GetInt();

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query to check if the Series ID exists

    sprintf(strSQL, "SELECT `Series ID`"
                         ", `Series Name`"
                    "FROM `Book Series` "
                    "WHERE `Series ID` = %d", intSeriesID);


    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
        printf("%s() -- SQL error", __func__);
        printf("\n");
         
        mysql_close(conn);
        return;
     }
    
 // store the result of the query
 
     res = mysql_store_result(conn);
     if(res == NULL)
     {
         printf("%s() -- No results returned", __func__);
         printf("\n");
         
         mysql_free_result(res);
         mysql_close(conn);
         return;
     }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching Series ID: %d", intSeriesID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
        bSeriesExists = false;
    }
    else
    {
        bSeriesExists = true;
        row = mysql_fetch_row(res);
        printf("\n");
        printf("Series Name: %s", row[1]);
        printf("\n\n");
        printf("Changed Series Name: ");
        strSeriesName = GetString();
    }

// execute a query to change the series if the series exists

    if((bTitlesExist == false) && (bSeriesExists == true))
    {
        sprintf(strSQL, "UPDATE `Book Series`"
                       " SET `Series Name` = '%s'"
                       " WHERE `Series ID` = %d", strSeriesName, intSeriesID);

        if(mysql_query(conn, strSQL) != 0)
        {
            printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
            printf("\n\n");
            printf("Press enter to continue ");
            while (getchar() != '\n')
            {
                continue;
            }
        } else
        {
            printf("\n");
            printf("Series ID: %d updated", intSeriesID);
            printf("\n\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
        }
    }

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fUpdateSource(char *strPrgNme)
{
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char *strSourceName = NULL;
    char strSQL[SQL_LEN] = {'\0'};
    int  intRowsReturned = 0;
    int  intSourceID = 0;
    bool bSourceExists = false;
    bool bTitlesExist = false;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

// retitle the console

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Sources > Change");
    printf("\n\n");

// get an Source ID to delete

    printf("Source ID: ");
    intSourceID = GetInt();

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query to check if the Source ID exists

    sprintf(strSQL, "SELECT `Source ID`"
                         ", `Source Name`"
                    "FROM `Book Sources` "
                    "WHERE `Source ID` = %d", intSourceID);


    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
        printf("%s() -- SQL error", __func__);
        printf("\n");
         
        mysql_close(conn);
        return;
     }
    
 // store the result of the query
 
     res = mysql_store_result(conn);
     if(res == NULL)
     {
         printf("%s() -- No results returned", __func__);
         printf("\n");
         
         mysql_free_result(res);
         mysql_close(conn);
         return;
     }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching Sourc ID: %d", intSourceID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
        bSourceExists = false;
    }
    else
    {
        bSourceExists = true;
        row = mysql_fetch_row(res);
        printf("\n");
        printf("Source Name: %s", row[1]);
        printf("\n\n");
        printf("Changed Source Name: ");
        strSourceName = GetString();
    }

// execute a query to change the source if the source exists

    if((bTitlesExist == false) && (bSourceExists == true))
    {
        sprintf(strSQL, "UPDATE `Book Sources`"
                       " SET `Source Name` = '%s'"
                       " WHERE `Source ID` = %d", strSourceName, intSourceID);

        if(mysql_query(conn, strSQL) != 0)
        {
            printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
            printf("\n\n");
            printf("Press enter to continue ");
            while (getchar() != '\n')
            {
                continue;
            }
        } else
        {
            printf("\n");
            printf("Source ID: %d updated", intSourceID);
            printf("\n\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
        }
    }

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fUpdateStatus(char *strPrgNme)
{
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char *strStatusName = NULL;
    char strSQL[SQL_LEN] = {'\0'};
    int  intRowsReturned = 0;
    int  intStatusID = 0;
    bool bStatusExists = false;
    bool bTitlesExist = false;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

// retitle the console

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Status > Change");
    printf("\n\n");

// get an Status ID to delete

    printf("Status ID: ");
    intStatusID = GetInt();

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query to check if the Status ID exists

    sprintf(strSQL, "SELECT `Status ID`"
                         ", `Status Name`"
                    "FROM `Book Statuses` "
                    "WHERE `Status ID` = %d", intStatusID);


    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
        printf("%s() -- SQL error", __func__);
        printf("\n");
         
        mysql_close(conn);
        return;
     }
    
 // store the result of the query
 
     res = mysql_store_result(conn);
     if(res == NULL)
     {
         printf("%s() -- No results returned", __func__);
         printf("\n");
         
         mysql_free_result(res);
         mysql_close(conn);
         return;
     }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching Status ID: %d", intStatusID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
        bStatusExists = false;
    }
    else
    {
        bStatusExists = true;
        row = mysql_fetch_row(res);
        printf("\n");
        printf("Status Name: %s", row[1]);
        printf("\n\n");
        printf("Changed Status Name: ");
        strStatusName = GetString();
    }

// execute a query to change the Status if the status exists

    if((bTitlesExist == false) && (bStatusExists == true))
    {
        sprintf(strSQL, "UPDATE `Book Statuses`"
                       " SET `Status Name` = '%s'"
                       " WHERE `Status ID` = %d", strStatusName, intStatusID);

        if(mysql_query(conn, strSQL) != 0)
        {
            printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
            printf("\n\n");
            printf("Press enter to continue ");
            while (getchar() != '\n')
            {
                continue;
            }
        } else
        {
            printf("\n");
            printf("Status ID: %d updated", intStatusID);
            printf("\n\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
        }
    }

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

void fUpdateGenre(char *strPrgNme)
{
    char *strServer = "192.168.0.13";
    char *strUser = "gjarman";
    char *strPassword = "Mpa4egu$";
    char *strDatabase = "risingfast";
    char *strGenreName = NULL;
    char strSQL[SQL_LEN] = {'\0'};
    int  intRowsReturned = 0;
    int  intGenreID = 0;
    bool bGenreExists = false;
    bool bTitlesExist = false;

    MYSQL *conn;
    MYSQL_RES *res;
    MYSQL_ROW row;

// retitle the console

    fRetitleConsole(strPrgNme);
    printf("\n");
    printf("Main Menu > Maintain Attributes > Genres > Change");
    printf("\n\n");

// get an Genre ID to delete

    printf("Genre ID: ");
    intGenreID = GetInt();

// initialize a connection and connect to the database

    conn = mysql_init(NULL);

    if(!mysql_real_connect(conn, strServer, strUser, strPassword, strDatabase, 0, NULL, 0))
    {
        printf("\nFailed in function: %s() to connect to MySQL Server at: %s\n\nError: %s\n", __func__, strServer, mysql_error(conn));
        printf("\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// execute the query to check if the Genre ID exists

    sprintf(strSQL, "SELECT `Genre ID`"
                         ", `Genre Name`"
                    "FROM `Book Genres` "
                    "WHERE `Genre ID` = %d", intGenreID);


    if(mysql_query(conn, strSQL) != 0)
    {
        printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while (getchar() != '\n')
        {
            continue;
        }
        mysql_close(conn);
        return;
    }

// test for a SQL error

     if(*mysql_error(conn))
     {
        printf("\n");
        printf("SQL Error in function %s():\n\n%s", __func__, mysql_error(conn));
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
 
        printf("%s() -- SQL error", __func__);
        printf("\n");
         
        mysql_close(conn);
        return;
     }
    
 // store the result of the query
 
     res = mysql_store_result(conn);
     if(res == NULL)
     {
         printf("%s() -- No results returned", __func__);
         printf("\n");
         
         mysql_free_result(res);
         mysql_close(conn);
         return;
     }

// fetch the number of fields and rows in the result

    intRowsReturned = mysql_num_rows(res);

    if(intRowsReturned == 0)
    {
        printf("\n");
        printf("No matching Genre ID: %d", intGenreID);
        printf("\n\n");
        printf("Press enter to continue ");
        while(getchar() != '\n')
        {
            continue;
        }
        bGenreExists = false;
    }
    else
    {
        bGenreExists = true;
        row = mysql_fetch_row(res);
        printf("\n");
        printf("Genre Name: %s", row[1]);
        printf("\n\n");
        printf("Changed Genre Name: ");
        strGenreName = GetString();
    }

// execute a query to change the genre if the genre exists

    if((bTitlesExist == false) && (bGenreExists == true))
    {
        sprintf(strSQL, "UPDATE `Book Genres`"
                       " SET `Genre Name` = '%s'"
                       " WHERE `Genre ID` = %d", strGenreName, intGenreID);

        if(mysql_query(conn, strSQL) != 0)
        {
            printf("mysql_query() error in function %s():\n\n%s", __func__, mysql_error(conn));
            printf("\n\n");
            printf("Press enter to continue ");
            while (getchar() != '\n')
            {
                continue;
            }
        } else
        {
            printf("\n");
            printf("Genre ID: %d updated", intGenreID);
            printf("\n\n");
            printf("Press enter to continue ");
            while(getchar() != '\n')
            {
                continue;
            }
        }
    }

    mysql_free_result(res);
    mysql_close(conn);
    return;
}

